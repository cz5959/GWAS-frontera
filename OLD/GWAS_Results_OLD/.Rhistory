df[df$X1 < 0 | df$X1 >1 ,]
df[df$X1 < 0 | df$X1 > 1 ,]
which(df$X1 < 0 | df$X1 > 1)
sample(100,4)
set.seed(1)
sample(100,4)
sample(100,4)
sample(100,4)
sample(100,4)
sample(100,4)
set.seed(1)
sample(100,4)
df=matrix(cbind(a,b,c),nrow=10,ncol=3)
a=rep(0:1,5)
b=rep(0:10,10)
c=rep(0:10,10)
df=matrix(cbind(a,b,c),nrow=10,ncol=3)
df
a=rep(0:10,10)
matrix(1:9, nrow = 3, ncol = 3)
matrix(1:8, nrow = 2, ncol = 3)
matrix(1:8, nrow = 8, ncol = 1)
m = matrix(1:8, nrow = 8, ncol = 1)
m.transpose()
m = matrix(1:8, nrow = 8, ncol = 1)
m2 = matrix(8:16, nrow = 8, ncol = 1)
m = matrix(1:8, nrow = 8, ncol = 1)
m2 = matrix(9:16, nrow = 8, ncol = 1)
m3 <- cbind(m,m2)
m3
m2 = matrix(9:24, nrow = 8, ncol = 2)
m3 <- cbind(m,m2[,2])
m3
5/4
floor(5/4)
for (i in 5){
print(i)
}
x <- 5
for (i in x){
print(i)
}
for (i in range(x){
for (i in range(x)){
print(i)
}
print(i)
for (i in range(x)){
print(i)
}
for (i in range(x)){
print(i)
}
for (i in 0:x){
print(i)
}
a<-matrix(nrow=10,ncol=5)
b<-matrix(nrow=20,ncol=5)
a
x <- c(4, 1, 4, 5, 1, 6)
mtcars
df <- mtcars$mpg
df
df$mpg
len(df)
length(df)
length(mtcars$mpg)
month.days <- c(31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31)
names(month.days) <- month.name
month.days
names(month.days)
base <- names(month.days)
bas
base
base <- cbind(base, month.days)
base
month.days
base
base <- cbind(base, month.days)
base
cbind(paste("ba","se",sep=""),month.days)
for (i in 0:2) {
print(i)
}
print($i)
print(%i)
names <- paste("a", 1:4, sep="")
names
test$mix1 <- months
test <- matrix(c(1:12))
test
test <- matrix(r(1:12))
test <- matrix(, nrow=1,ncol=12)
test
test[,1] <- months
test <- matrix(, ncol=12)
test
test[,1] <- months
names(month.days)
month.days.names
month.days
colnames(month.days)
colnames(month.days) <- 1
mtcars
colnames(mtcars)
colnames(mtcars) <- cbind(1:11)
colnames(mtcars)
mtcars
colnames(mtcars) <- cbind(paste("mix_",1:11,sep="")
colnames(mtcars) <- cbind(paste("mix_",1:11,sep=""))
colnames(mtcars) <- cbind(paste("mix_",1:11,sep=""))
colnames(mtcars)
mtcars
mixture <- matrix(names(month.days),ncol=1)
mixture
colnames(mtcars) <- cbind("test",paste("mix_",1:10,sep=""))
colnames(mtcars)
cbind("test",paste("mix_",1:10,sep=""))
rbind("test",paste("mix_",1:10,sep=""))
cbind(paste("mix_",0:10,sep=""))
colnames(mtcars) <- cbind("test",paste("mix_",0:10,sep=""))
colnames(mtcars) <- cbind(paste("mix_",0:10,sep=""))
colnames(mtcars)
mtcars
x <- c(4, 1, 4, 5, 1, 6)
print(x)
2^2
#install.packages("mashr")
library(ashr)
library(mashr)
set.seed(1)
simdata = simple_sims(500,2,1)
data = mash_set_data(simdata$Bhat, simdata$Shat)
U.pca = cov_pca(data,5,subset=data)
U.pca = cov_pca(data,5)
strong = c(1,3,8,4,5,10)
U.pca = cov_pca(data,5,subset=strong)
strong
strong = get_significant_results(data,0.05)
strong <- 1:10; x
strong <- 1:10; strong
U.pca = cov_pca(data,5,subset=strong)
strong <- 1:100; strong
U.pca = cov_pca(data,5,subset=strong)
strong <- 1:2
U.pca = cov_pca(data,5,subset=strong)
data
str(data)
names(U.c)
U.c = cov_canonical(data)
names(U.c)
setwd("~/Research/GWAS-frontera/Phenotypes")
wth <- read.table("pheno_waist_to_hip.txt",sep="\t",head=TRUE)
bmi <- read.table("pheno_bmi.txt",sep="\t",head=TRUE)
head(bmi)
wth <- read.table("pheno_waist_to_hip.txt",sep="\t",head=FALSE)
bmi <- read.table("pheno_bmi.txt",sep="\t",head=FALSE)
bmi.head()
head(bmi)
wth <- read.table("pheno_waist_to_hip.txt",sep="\t",head=FALSE, col.names=c("FID","IID","wth") )
bmi <- read.table("pheno_bmi.txt",sep="\t",head=FALSE, col.names=c("FID","IID","bmi"))
head(bmi)
df <- merge(wth,bmi,by"IID")
df <- merge(wth,bmi,by"IID")
df <- merge(wth,bmi,by="IID")
head(Df)
head(df)
model <- lm(wth~bmi, data=df)
print(model)
wth_hat <- predict(model, newdata=df$bmi)
wth_hat <- predict(model, newdata=list(df$bmi))
head(list(df$bmi))
head(df$bmi)
x <- df$bmi
head(x)
str(x)
wth_hat <- predict(model, newdata=df$bmi)
x <- data.frame(df$bmi)
str(x)
x <- list(df$bmi)
str(x)
wth_hat <- predict(model, newdata=x)
x <- list(df$bmi)
str(x)
x <- unlist(df$bmi)
str(x)
wth_hat <- predict(model, newdata=x)
x <- data.frame(df$bmi)
str(x)
wth_hat <- predict(model, newdata=x)
wth_hat <- predict(model, newdata=x.bmi)
wth_hat <- predict(model, newdata=x$df.bmi)
wth_hat <- predict(model, newdata=df)
str(wth_hat)
df
head(df)
x <- df[-c(1,2,3,4)]
head(x)
wth_hat <- predict(model, newdata=x)
residual <- wth_hat - df$wth
head(residual)
pheno <- cbind(df$FID, df$IID, residual)
head(pheno)
pheno <- cbind(df$FID.x, df$IID, residual)
head(pheno)
pheno <- data.frame(df$FID.x, df$IID, residual)
head(pheno)
write.table(pheno, file="pheno_waist_to_hip_bmi.txt", sep="\t", row.names=FALSE)
nrow(pheno)
nrow(df)
setwd("~/Research/GWAS-frontera/Phenotypes")
df_vars <-  read.table("pheno_variances_bysex.txt", sep="\t",head=FALSE)
head(df_vars)
df_vars <-  read.table("pheno_variances_bysex.txt", sep="\t",head=TRUE)
head(df_vars)
setwd("~/Research/GWAS-frontera/GWAS_Results")
df_weights = pd.read_csv("sum_mash_weights.txt", sep="\t")
df_weights = read.table("sum_mash_weights.txt", sep="\t")
head(df_weights)
df_weights = read.table("sum_mash_weights.txt", sep="\t",head=TRUE)
head(df_weights)
df_vars <- df_vars[df_vars$pheno %in% df_weights$phenotype,]
nrow(df_vars)
nrow(df_weights)
order(df_vars$pheno)
df_vars <- df_vars[order(df_vars$pheno),]
df_weights <- df_weights[order(df_weights$phenotype),]
head(df_weights)
row.names(df_vars) <- NULL
head(df_vars)
row.names(df_vars) <- NULL ; row.names(df_weights) <- NULL
head(df_weights)
# get ratio and difference
df_vars$ratio_mtof <- df_vars$m_var / df_vars$f_var
head(df_vars)
df_weights$diff_mf <- df_weights$sum_weight_m - df_weights$sum_weight_f
head(df_weights)
plot(df_vars$ratio_mtof, df_weights$diff_mf)
axis.break(1,2)
axis.break()
library("plotrix")
install.packages("plotrix")
library("plotrix")
plot(df_vars$ratio_mtof, df_weights$diff_mf)
axis.break()
twogrp <- c(rnorm(10) + 4, rnorm(10) + 20)
gap.plot(twogrp,gap = c(8,16), xlab = "Index", ylab = "Group values",
main = "Two separated groups with gap axis break",
col = c(rep(2, 10), rep(3, 10)), ytics = c(3, 5, 18, 20))
legend(12, 6, c("Low group", "High group"), pch = 1, col = 2:3)
twogrp <- c(rnorm(10) + 4, rnorm(10) + 20)
gap.plot(twogrp,gap = c(8,16), xlab = "Index", ylab = "Group values",
main = "Two separated groups with gap axis break",
col = c(rep(2, 10), rep(3, 10)), ytics = c(3, 5, 18, 20))
print(twogrp)
str(twogrp)
plot(3:10, main = "Axis break test")
axis.break()
axis.break(2, 2.9, style = "zigzag")
twogrp <- c(rnorm(10) + 4, rnorm(10) + 20)
gap.plot(twogrp,gap = c(8,16), xlab = "Index", ylab = "Group values",
main = "Two separated groups with gap axis break",
col = c(rep(2, 10), rep(3, 10)), ytics = c(3, 5, 18, 20))
plot(df_vars$ratio_mtof, df_weights$diff_mf)
gap.plot(x=df_vars$ratio_mtof, y=df_weights$diff_mf)
gap.plot(x=df_vars$ratio_mtof, y=df_weights$diff_mf, gap.axis="x",col=c(rep(2,10),rep(3,10)))
gap.plot(x=df_vars$ratio_mtof, y=df_weights$diff_mf, gap.axis=c(8,16),col=c(rep(2,10),rep(3,10)))
gap.plot(x=df_vars$ratio_mtof, y=df_weights$diff_mf, gap=c(8,16),col=c(rep(2,10),rep(3,10)))
gap.plot(x=df_vars$ratio_mtof, y=df_weights$diff_mf, gap=c(8,25), col=c(rep(2,10),rep(3,10)))
gap.plot(x=df_vars$ratio_mtof, y=df_weights$diff_mf, gap.axis="y",gap=c(4,27), col=c(rep(2,10),rep(3,10)))
gap.plot(x=df_vars$ratio_mtof, y=df_weights$diff_mf, gap.axis="x",gap=c(4,27), col=c(rep(2,10),rep(3,10)))
gap.plot(x=df_vars$ratio_mtof, y=df_weights$diff_mf, gap.axis="x",gap=c(4,27))
gap.plot(x=df_vars$ratio_mtof, y=df_weights$diff_mf, gap.axis="y",gap=c(60,80))
gap.plot(x=df_vars$ratio_mtof, y=df_weights$diff_mf, gap.axis="x", gap=c(4,27), type="b")
gap.plot(x=df_vars$ratio_mtof, y=df_weights$diff_mf, gap.axis="x", gap=c(4,27), type="p")
gap.plot(x=df_vars$ratio_mtof, y=df_weights$diff_mf, gap.axis="x", gap=c(4,27), type="b)
gap.plot(x=df_vars$ratio_mtof, y=df_weights$diff_mf, gap.axis="x", gap=c(4,27), type="b")
axis.break()
gap.plot(x=df_vars$ratio_mtof, y=df_weights$diff_mf, gap.axis="x", gap=c(4,27), type="b")
gap.plot(x=df_vars$ratio_mtof, y=df_weights$diff_mf, gap.axis="x", gap=c(4,27))
axis.break(2,4,style="gap")
axis.break(1,4,style="gap")
gap.plot(x=df_vars$ratio_mtof, y=df_weights$diff_mf, gap.axis="x", gap=c(4,27))
axis.break(1,4,style="gap")
axis.break(1,4,breakcol="snow",style="gap")
axis.break(1, 4*(1+0.02), breakcol="black", style="slash")
axis.break(3, 4*(1+0.02), breakcol="black", style="slash")
axis.break(1,4,breakcol="white",style="gap")
axis.break(1, 4*(1+0.02), breakcol="black", style="slash")
axis.break(3, 4*(1+0.02), breakcol="black", style="slash")
par(bty="n")
gap.plot(x=df_vars$ratio_mtof, y=df_weights$diff_mf, gap.axis="x", gap=c(4,27))
axis.break(1,4,breakcol="white",style="gap")
axis.break(1, 4*(1+0.02), breakcol="black", style="slash")
axis.break(3, 4*(1+0.02), breakcol="black", style="slash")
axis.break(2, 4*(1+0.02), breakcol="black", style="slash")
axis.break(2, 60*(1+0.02), breakcol="black", style="slash")
install.packages("ggrepel")
library("ggrepel")
par(bty="n")
gap.plot(x=df_vars$ratio_mtof, y=df_weights$diff_mf, gap.axis="x", gap=c(4,27))
axis.break(1,4,breakcol="white",style="gap")
axis.break(1, 4*(1+0.02), breakcol="black", style="slash")
axis.break(2, 60*(1+0.02), breakcol="black", style="slash")
x <- df_vars$ratio_mtof
y <- df_weights$diff_mf
par(bty="n")
gap.plot(x, y, gap.axis="x", gap=c(4,27))
axis.break(1,4,breakcol="white",style="gap")
axis.break(1, 4*(1+0.02), breakcol="black", style="slash")
axis.break(2, 60*(1+0.02), breakcol="black", style="slash")
df_weights
geom_text(aes(x,y,label=df_weights$phenotype))
gap.plot(x, y, gap.axis="x", gap=c(4,27)) + geom_text(aes(x,y,label=df_weights$phenotype))
ggplot(x,y)
ggplot(x,y)
mtcars
help(ggplot)
ggplot() + geom_point(aes(x,y)) + geom_text(aes(x,y,label=df_weights$phenotype))
ggplot() + geom_point(aes(x,y)) + geom_text(aes(x,y,label=df_weights$phenotype)) + theme_classic(base_size=16)
gap.plot(x, y, gap.axis="x", gap=c(4,27)) + geom_text(aes(x,y,label=df_weights$phenotype))
p1 <- ggplot() + geom_point(aes(x,y)) + geom_text(aes(x,y,label=df_weights$phenotype)) + theme_classic(base_size=16)
p1
p1 + scale_x_break(c(4,27))
install.package("ggplot2")
install.packages("ggplot2")
install.packages("ggplot2")
p1 <- ggplot2() + geom_point(aes(x,y)) + geom_text(aes(x,y,label=df_weights$phenotype)) + theme_classic(base_size=16)
library("ggplot2")
p1 <- ggplot2() + geom_point(aes(x,y)) + geom_text(aes(x,y,label=df_weights$phenotype)) + theme_classic(base_size=16)
p1 <- ggplot() + geom_point(aes(x,y)) + geom_text(aes(x,y,label=df_weights$phenotype)) + theme_classic(base_size=16)
p1 + scale_x_break(c(4,27))
library("ggbreak")
install.packages("ggbreak")
library("ggbreak")
p1 <- ggplot() + geom_point(aes(x,y)) + geom_text(aes(x,y,label=df_weights$phenotype)) + theme_classic(base_size=16)
p1 + scale_x_break(c(4,27))
p1 <- ggplot() + geom_point(aes(x,y)) + geom_text(aes(x,y,label=df_weights$phenotype)) + theme_classic(base_size=16)
p1 + scale_x_break(c(4,27)) + scale_y_break(c(60,80))
p1 <- ggplot() + geom_point(aes(x,y)) + geom_text(aes(x,y,label=df_weights$phenotype)) + theme_classic(base_size=16)
p1
p1 + scale_x_break(c(4,27)) + scale_y_break(c(60,80))
x <- subset(df_vars, !(df_vars$ratio_mtof %in% outliers))
outliers <- c("testosterone", "arm_fatfree_mass_R", "arm_fatfree_mass_L")
x <- subset(df_vars, !(df_vars$ratio_mtof %in% outliers))
y <- subset(df_weights, !(df_weights$diff_mf %in% outliers))
par(bty="n")
gap.plot(x, y, gap.axis="x", gap=c(4,27))
x <- subset(df_vars, !(df_vars$pheno %in% outliers))
y <- subset(df_weights, !(df_weights$phenotype %in% outliers))
head(x)
x <- subset(df_vars, !(df_vars$pheno %in% outliers))$ratio_mtof
y <- subset(df_weights, !(df_weights$phenotype %in% outliers))$diff_mf
x
par(bty="n")
gap.plot(x, y, gap.axis="x", gap=c(4,27))
x
y
p1 <- ggplot() + geom_point(aes(x,y)) + geom_text(aes(x,y,label=df_weights$phenotype)) + theme_classic(base_size=16)
p1
outliers <- c("testosterone", "arm_fatfree_mass_R", "arm_fatfree_mass_L")
main_vars <- subset(df_vars, !(df_vars$pheno %in% outliers))
main_weights <- subset(df_weights, !(df_weights$phenotype %in% outliers))
x <- main_vars$ratio_mtof
y <- main_weights$diff_mf
p1 <- ggplot() + geom_point(aes(x,y)) + geom_text(aes(x,y,label=df_weights$phenotype)) + theme_classic(base_size=16)
p1
p1 <- ggplot() + geom_point(aes(x,y)) + geom_text(aes(x,y,label=main_weights$phenotype)) + theme_classic(base_size=16)
p1
out_vars <- subset(df_vars, (df_vars$pheno %in% outliers))
out_weights <- subset(df_weights, (df_weights$phenotype %in% outliers))
out_vars <- subset(df_vars, (df_vars$pheno %in% outliers))
out_weights <- subset(df_weights, (df_weights$phenotype %in% outliers))
out_x <- out_vars$ratio_mtof
out_y <- out_weights$diff_mf
main_vars <- subset(df_vars, !(df_vars$pheno %in% outliers))
main_x <- main_vars$ratio_mtof
main_weights <- subset(df_weights, !(df_weights$phenotype %in% outliers))
main_y <- main_weights$diff_mf
p1 <- ggplot() + geom_point(aes(main_x,main_y)) + geom_text(aes(x,y,label=main_weights$phenotype)) + theme_classic(base_size=16)
p2 <- ggplot() + geom_point(aes(out_x,out_y)) + geom_text(aes(x,y,label=out_weights$phenotype)) + theme_classic(base_size=16)
p1
p2
p1 <- ggplot() + geom_point(aes(main_x,main_y)) + geom_text(aes(main_x,main_y,label=main_weights$phenotype)) + theme_classic(base_size=16)
p2 <- ggplot() + geom_point(aes(out_x,out_y)) + geom_text(aes(out_x,out_y,label=out_weights$phenotype)) + theme_classic(base_size=16)
p2
p1
grid.arrange(p1,p2,nrow=2)
library("gridExtra")
install.packages("gridExtra")
library("gridExtra")
2
grid.arrange(p1,p2)
p3 <- grid.arrange(p1,p2)
p3
help(grid.arrange)
grid.arrange(p2,p1,nrow=2,heights=2,6)
p3 <- grid.arrange(p2,p1,heights=2,6)
p3 <- grid.arrange(p2,p1,heights=c(2,6))
help(ggplot)
p1 <- ggplot() + geom_point(aes(main_x,main_y)) +
geom_text(aes(main_x,main_y,label=main_weights$phenotype)) +
theme_classic(base_size=16)
p2 <- ggplot() + geom_point(aes(out_x,out_y)) + geom_text(aes(out_x,out_y,label=out_weights$phenotype)) + theme_classic(base_size=16)
grid.newpage()
library("grid")
grid.newpage()
gird.draw(rbind(ggplotGrob(p1),ggplotGrob(p2) ))
grid.draw(rbind(ggplotGrob(p1),ggplotGrob(p2) ))
p1 <- ggplot() + geom_point(aes(main_x,main_y)) +
geom_text(aes(main_x,main_y,label=main_weights$phenotype)) +
theme_minimal(base_size=16) +
p2 <- ggplot() + geom_point(aes(out_x,out_y)) +
geom_text(aes(out_x,out_y,label=out_weights$phenotype)) +
theme_classic(base_size=16)
grid.newpage()
grid.draw(rbind(ggplotGrob(p1),ggplotGrob(p2)))
p1 <- ggplot() + geom_point(aes(main_x,main_y)) +
geom_text(aes(main_x,main_y,label=main_weights$phenotype)) +
theme_minimal() +
p2 <- ggplot() + geom_point(aes(out_x,out_y)) +
geom_text(aes(out_x,out_y,label=out_weights$phenotype)) +
theme_classic(base_size=16)
grid.newpage()
grid.draw(rbind(ggplotGrob(p1),ggplotGrob(p2)))
p2 <- ggplot() + geom_point(aes(out_x,out_y)) +
geom_text(aes(out_x,out_y,label=out_weights$phenotype)) +
theme_minimal() + theme(axis.title.x = element_blank(), axis.text.x = element_blank())
grid.newpage()
grid.draw(rbind(ggplotGrob(p1),ggplotGrob(p2)))
grid.newpage()
grid.draw(rbind(ggplotGrob(p2),ggplotGrob(p1)))
p1 <- ggplot() + geom_point(aes(main_x,main_y)) +
geom_text(aes(main_x,main_y,label=main_weights$phenotype)) +
theme_minimal()
p2 <- ggplot() + geom_point(aes(out_x,out_y)) +
geom_text(aes(out_x,out_y,label=out_weights$phenotype)) +
theme_minimal() + theme(axis.title.x = element_blank(), axis.text.x = element_blank())
grid.newpage()
grid.draw(rbind(ggplotGrob(p2),ggplotGrob(p1)))
y <- df_weights$diff_mf
x <- df_vars$ratio_mtof
ggplot() + geom_point(aes(x,y)) + facet_grid(variable ~ ., scale="free_y")
ggplot() + geom_point(aes(x,y)) + facet_grid(variable ~ ., scale="free_y") +
geom_text(aes(main_x,main_y,label=main_weights$phenotype)) +
theme_minimal()
ggplot() + geom_point(aes(x,y)) + facet_grid(y ~ ., scale="free_y") +
geom_text(aes(main_x,main_y,label=main_weights$phenotype)) +
theme_minimal()
dat <- get.ohlc.yahoo('AAPL', '2015-12-01', '2015-12-31')
p1 <- ggplot() + geom_point(aes(main_x,main_y)) +
geom_text(aes(main_x,main_y,label=main_weights$phenotype)) +
theme_minimal()
p2 <- ggplot() + geom_point(aes(out_x,out_y)) +
geom_text(aes(out_x,out_y,label=out_weights$phenotype)) +
theme_minimal() + theme(axis.title.x = element_blank(), axis.text.x = element_blank())
grid.newpage()
grid.draw(rbind(ggplotGrob(p2),ggplotGrob(p1)))
p1 <- ggplot() + geom_point(aes(main_x,main_y)) +
geom_text(aes(main_x,main_y,label=main_weights$phenotype)) +
theme_gray()
p2 <- ggplot() + geom_point(aes(out_x,out_y)) +
geom_text(aes(out_x,out_y,label=out_weights$phenotype)) +
theme_gray() + theme(axis.title.x = element_blank(), axis.text.x = element_blank())
grid.newpage()
grid.draw(rbind(ggplotGrob(p2),ggplotGrob(p1)))
p1 <- ggplot() + geom_point(aes(main_x,main_y)) +
geom_text(aes(main_x,main_y,label=main_weights$phenotype)) +
theme_void()
p2 <- ggplot() + geom_point(aes(out_x,out_y)) +
geom_text(aes(out_x,out_y,label=out_weights$phenotype)) +
theme_void() + theme(axis.title.x = element_blank(), axis.text.x = element_blank())
grid.newpage()
grid.draw(rbind(ggplotGrob(p2),ggplotGrob(p1)))
p1 <- ggplot() + geom_point(aes(main_x,main_y)) +
geom_text(aes(main_x,main_y,label=main_weights$phenotype)) +
theme_classic()
p2 <- ggplot() + geom_point(aes(out_x,out_y)) +
geom_text(aes(out_x,out_y,label=out_weights$phenotype)) +
theme_classic() + theme(axis.title.x = element_blank(), axis.text.x = element_blank())
grid.newpage()
grid.draw(rbind(ggplotGrob(p2),ggplotGrob(p1)))
p2 <- ggplot() + geom_point(aes(out_x,out_y)) +
geom_text(aes(out_x,out_y,label=out_weights$phenotype)) +
theme_classic() +
theme(axis.title.x = element_blank(), axis.text.x = element_blank(), axis.line.x = element_blank())
grid.newpage()
grid.draw(rbind(ggplotGrob(p2),ggplotGrob(p1)))
b <- element_blank()
p2 <- ggplot() + geom_point(aes(out_x,out_y)) +
geom_text(aes(out_x,out_y,label=out_weights$phenotype)) +
theme_classic() +
theme(axis.title.x = b, axis.text.x = b, axis.line.x = b, axis.ticks.x=b)
grid.newpage()
grid.draw(rbind(ggplotGrob(p2),ggplotGrob(p1)))
p1 <- ggplot() + geom_point(aes(main_x,main_y)) + xlim(0,28) +
geom_text(aes(main_x,main_y,label=main_weights$phenotype)) +
theme_classic()
p2 <- ggplot() + geom_point(aes(out_x,out_y)) + xlim(0,28) +
geom_text(aes(out_x,out_y,label=out_weights$phenotype)) +
theme_classic() +
theme(axis.title.x = b, axis.text.x = b, axis.line.x = b, axis.ticks.x=b)
grid.newpage()
grid.draw(rbind(ggplotGrob(p2),ggplotGrob(p1)))
p2 <- ggplot() + geom_point(aes(out_x,out_y)) + xlim(0,28) + scale_x_break(x(4,27))
p2 <- ggplot() + geom_point(aes(out_x,out_y)) + xlim(0,28) + scale_x_break(c(4,27)) +
geom_text(aes(out_x,out_y,label=out_weights$phenotype)) +
theme_classic() +
theme(axis.title.x = b, axis.text.x = b, axis.line.x = b, axis.ticks.x=b)
grid.newpage()
grid.draw(rbind(ggplotGrob(p2),ggplotGrob(p1)))
axis.break(1, 4*(1+0.02), breakcol="black", style="slash")
