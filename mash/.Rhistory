#setwd("~/Research/GWAS-frontera/mash/heatmaps")
#pdf(file=paste0(pheno,"_mash_large.pdf"), width=6.5, height=4.8)
#setwd("~/Research/GWAS-frontera/mash/heatmaps/png_files")
#png(file=paste0(pheno,"_mash_large.png"), width=6.5, height=4.8, units="in", res=300)
setwd("~/Research/GWAS-frontera/Supp Figures/mash heatmaps")
big <- ggplot(df_ave, aes(x= magnitude, y= correlation, fill= Mean)) +
geom_tile(color= "white", lwd= 1.5, linetype= 1) +
geom_text(aes(label=percent_lab), color= "black", size= 2.6, vjust=-0.1) +
geom_text(aes(label=round(SE,3)), color= "black", size= 2, vjust=1.5) +
scale_y_continuous(breaks=seq(-1,1,0.25), expand=c(0,0)) +
scale_x_discrete(labels= effect_labels) +
labs(title="Weights on Hypothesis Covariance Matrices") +
xlab("Magnitude") + ylab("Correlation") +
theme_pubclean() +
#theme(axis.text=element_text(size=9), axis.title = element_text(size=11), plot.title = element_text(size=14),
#     legend.position = "none") +
theme(axis.text=element_text(size=9), axis.title = element_text(size=11), plot.title = element_blank(),
legend.position = "none") +
scale_fill_gradient(low="gray98",high="#829ed9")
small <- ggplot(df_null, aes(x= 0, y= 0, fill= Mean)) +
geom_tile(color= "white", lwd= 1.5, linetype= 1) +
geom_text(aes(label=percent_lab), color= "white", size= 2.6, vjust=-0.1) +
geom_text(aes(label=round(SE,3)), color= "white", size= 2, vjust=1.5) +
scale_y_continuous(expand=c(0,0)) +
ylab("Weight of \nNo Effect Matrix") +
theme_pubclean() +
theme(axis.text=element_blank(), axis.title=element_blank(),
axis.title.y = element_text(size=10, angle=360, vjust=0.5),
legend.position = "none",axis.ticks = element_blank(), plot.title = element_blank()) +
scale_fill_gradient(low="#2b62d9",high="#2b62d9")
lay <- rbind( c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(2,2,3,3,3))
p <- gridExtra::grid.arrange(big, small, ncol=1, layout_matrix=lay)
df_null <- df_null %>%
mutate(Mean = as.numeric(Mean)) %>%
mutate(mean_lab = ifelse(Mean < 0.0005, "0%", sprintf("%.1f%%", round(Mean*100,1)) )) %>%
mutate(se_lab = ifelse(SE < 0.0005, "0%", sprintf("%.1f%%", round(SE*100,1)) ))
df_ave <- df_ave %>%
mutate(Mean = as.numeric(Mean)) %>%
mutate(mean_lab = ifelse(Mean < 0.0005, "0%", sprintf("%.1f%%", round(Mean*100,1)) )) %>%
mutate(se_lab = ifelse(SE < 0.0005, "0%", sprintf("%.1f%%", round(SE*100,1)) ))
effect_labels <-  c('female-\nspecific','female x3', 'female x2', 'female x1.5','equal','male x1.5','male x2','male x3','male-\nspecific')
#setwd("~/Research/GWAS-frontera/mash/heatmaps")
#pdf(file=paste0(pheno,"_mash_large.pdf"), width=6.5, height=4.8)
#setwd("~/Research/GWAS-frontera/mash/heatmaps/png_files")
#png(file=paste0(pheno,"_mash_large.png"), width=6.5, height=4.8, units="in", res=300)
setwd("~/Research/GWAS-frontera/Supp Figures/mash heatmaps")
big <- ggplot(df_ave, aes(x= magnitude, y= correlation, fill= Mean)) +
geom_tile(color= "white", lwd= 1.5, linetype= 1) +
geom_text(aes(label=mean_lab), color= "black", size= 2.6, vjust=-0.1) +
geom_text(aes(label=se_lab), color= "black", size= 2, vjust=1.5) +
scale_y_continuous(breaks=seq(-1,1,0.25), expand=c(0,0)) +
scale_x_discrete(labels= effect_labels) +
labs(title="Weights on Hypothesis Covariance Matrices") +
xlab("Magnitude") + ylab("Correlation") +
theme_pubclean() +
#theme(axis.text=element_text(size=9), axis.title = element_text(size=11), plot.title = element_text(size=14),
#     legend.position = "none") +
theme(axis.text=element_text(size=9), axis.title = element_text(size=11), plot.title = element_blank(),
legend.position = "none") +
scale_fill_gradient(low="gray98",high="#829ed9")
small <- ggplot(df_null, aes(x= 0, y= 0, fill= Mean)) +
geom_tile(color= "white", lwd= 1.5, linetype= 1) +
geom_text(aes(label=mean_lab), color= "white", size= 2.6, vjust=-0.1) +
geom_text(aes(label=se_lab), color= "white", size= 2, vjust=1.5) +
scale_y_continuous(expand=c(0,0)) +
ylab("Weight of \nNo Effect Matrix") +
theme_pubclean() +
theme(axis.text=element_blank(), axis.title=element_blank(),
axis.title.y = element_text(size=10, angle=360, vjust=0.5),
legend.position = "none",axis.ticks = element_blank(), plot.title = element_blank()) +
scale_fill_gradient(low="#2b62d9",high="#2b62d9")
lay <- rbind( c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(2,2,3,3,3))
p <- gridExtra::grid.arrange(big, small, ncol=1, layout_matrix=lay)
small <- ggplot(df_null, aes(x= 0, y= 0, fill= Mean)) +
geom_tile(color= "white", lwd= 1.5, linetype= 1) +
geom_text(aes(label=mean_lab), color= "white", size= 2.6, vjust=-0.1) +
geom_text(aes(label=paste0("Â±",se_lab)), color= "white", size= 2, vjust=1.5) +
scale_y_continuous(expand=c(0,0)) +
ylab("Weight of \nNo Effect Matrix") +
theme_pubclean() +
theme(axis.text=element_blank(), axis.title=element_blank(),
axis.title.y = element_text(size=10, angle=360, vjust=0.5),
legend.position = "none",axis.ticks = element_blank(), plot.title = element_blank()) +
scale_fill_gradient(low="#2b62d9",high="#2b62d9")
lay <- rbind( c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(2,2,3,3,3))
p <- gridExtra::grid.arrange(big, small, ncol=1, layout_matrix=lay)
small <- ggplot(df_null, aes(x= 0, y= 0, fill= Mean)) +
geom_tile(color= "white", lwd= 1.5, linetype= 1) +
geom_text(aes(label=mean_lab), color= "white", size= 2.6, vjust=-0.1) +
geom_text(aes(label=paste0("\u00B1",se_lab)), color= "white", size= 2, vjust=1.5) +
scale_y_continuous(expand=c(0,0)) +
ylab("Weight of \nNo Effect Matrix") +
theme_pubclean() +
theme(axis.text=element_blank(), axis.title=element_blank(),
axis.title.y = element_text(size=10, angle=360, vjust=0.5),
legend.position = "none",axis.ticks = element_blank(), plot.title = element_blank()) +
scale_fill_gradient(low="#2b62d9",high="#2b62d9")
lay <- rbind( c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(2,2,3,3,3))
p <- gridExtra::grid.arrange(big, small, ncol=1, layout_matrix=lay)
big <- ggplot(df_ave, aes(x= magnitude, y= correlation, fill= Mean)) +
geom_tile(color= "white", lwd= 1.5, linetype= 1) +
geom_text(aes(label=mean_lab), color= "black", size= 2.6, vjust=-0.1) +
geom_text(aes(label=paste0("\u00B1",se_lab)), color= "black", size= 2, vjust=1.5) +
scale_y_continuous(breaks=seq(-1,1,0.25), expand=c(0,0)) +
scale_x_discrete(labels= effect_labels) +
labs(title="Weights on Hypothesis Covariance Matrices") +
xlab("Magnitude") + ylab("Correlation") +
theme_pubclean() +
#theme(axis.text=element_text(size=9), axis.title = element_text(size=11), plot.title = element_text(size=14),
#     legend.position = "none") +
theme(axis.text=element_text(size=9), axis.title = element_text(size=11), plot.title = element_blank(),
legend.position = "none") +
scale_fill_gradient(low="gray98",high="#829ed9")
small <- ggplot(df_null, aes(x= 0, y= 0, fill= Mean)) +
geom_tile(color= "white", lwd= 1.5, linetype= 1) +
geom_text(aes(label=mean_lab), color= "white", size= 2.6, vjust=-0.1) +
geom_text(aes(label=paste0("\u00B1",se_lab)), color= "white", size= 2, vjust=1.5) +
scale_y_continuous(expand=c(0,0)) +
ylab("Weight of \nNo Effect Matrix") +
theme_pubclean() +
theme(axis.text=element_blank(), axis.title=element_blank(),
axis.title.y = element_text(size=10, angle=360, vjust=0.5),
legend.position = "none",axis.ticks = element_blank(), plot.title = element_blank()) +
scale_fill_gradient(low="#2b62d9",high="#2b62d9")
lay <- rbind( c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(2,2,3,3,3))
p <- gridExtra::grid.arrange(big, small, ncol=1, layout_matrix=lay)
big <- ggplot(df_ave, aes(x= magnitude, y= correlation, fill= Mean)) +
geom_tile(color= "white", lwd= 1.5, linetype= 1) +
geom_text(aes(label=mean_lab), color= "black", size= 2.6, vjust=-0.1) +
geom_text(aes(label=paste("\u00B1",se_lab)), color= "black", size= 2, vjust=1.5) +
scale_y_continuous(breaks=seq(-1,1,0.25), expand=c(0,0)) +
scale_x_discrete(labels= effect_labels) +
labs(title="Weights on Hypothesis Covariance Matrices") +
xlab("Magnitude") + ylab("Correlation") +
theme_pubclean() +
#theme(axis.text=element_text(size=9), axis.title = element_text(size=11), plot.title = element_text(size=14),
#     legend.position = "none") +
theme(axis.text=element_text(size=9), axis.title = element_text(size=11), plot.title = element_blank(),
legend.position = "none") +
scale_fill_gradient(low="gray98",high="#829ed9")
small <- ggplot(df_null, aes(x= 0, y= 0, fill= Mean)) +
geom_tile(color= "white", lwd= 1.5, linetype= 1) +
geom_text(aes(label=mean_lab), color= "white", size= 2.6, vjust=-0.1) +
geom_text(aes(label=paste("\u00B1",se_lab)), color= "white", size= 2, vjust=1.5) +
scale_y_continuous(expand=c(0,0)) +
ylab("Weight of \nNo Effect Matrix") +
theme_pubclean() +
theme(axis.text=element_blank(), axis.title=element_blank(),
axis.title.y = element_text(size=10, angle=360, vjust=0.5),
legend.position = "none",axis.ticks = element_blank(), plot.title = element_blank()) +
scale_fill_gradient(low="#2b62d9",high="#2b62d9")
lay <- rbind( c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(2,2,3,3,3))
p <- gridExtra::grid.arrange(big, small, ncol=1, layout_matrix=lay)
big <- ggplot(df_ave, aes(x= magnitude, y= correlation, fill= Mean)) +
geom_tile(color= "white", lwd= 1.5, linetype= 1) +
geom_text(aes(label=mean_lab), color= "black", size= 2.8, vjust=-0.1) +
geom_text(aes(label=paste("\u00B1",se_lab)), color= "black", size= 2.2, vjust=1.5) +
scale_y_continuous(breaks=seq(-1,1,0.25), expand=c(0,0)) +
scale_x_discrete(labels= effect_labels) +
labs(title="Weights on Hypothesis Covariance Matrices") +
xlab("Magnitude") + ylab("Correlation") +
theme_pubclean() +
#theme(axis.text=element_text(size=9), axis.title = element_text(size=11), plot.title = element_text(size=14),
#     legend.position = "none") +
theme(axis.text=element_text(size=9), axis.title = element_text(size=11), plot.title = element_blank(),
legend.position = "none") +
scale_fill_gradient(low="gray98",high="#829ed9")
small <- ggplot(df_null, aes(x= 0, y= 0, fill= Mean)) +
geom_tile(color= "white", lwd= 1.5, linetype= 1) +
geom_text(aes(label=mean_lab), color= "white", size= 2.8, vjust=-0.1) +
geom_text(aes(label=paste("\u00B1",se_lab)), color= "white", size= 2.2, vjust=1.5) +
scale_y_continuous(expand=c(0,0)) +
ylab("Weight of \nNo Effect Matrix") +
theme_pubclean() +
theme(axis.text=element_blank(), axis.title=element_blank(),
axis.title.y = element_text(size=10, angle=360, vjust=0.5),
legend.position = "none",axis.ticks = element_blank(), plot.title = element_blank()) +
scale_fill_gradient(low="#2b62d9",high="#2b62d9")
lay <- rbind( c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(2,2,3,3,3))
p <- gridExtra::grid.arrange(big, small, ncol=1, layout_matrix=lay)
big <- ggplot(df_ave, aes(x= magnitude, y= correlation, fill= Mean)) +
geom_tile(color= "white", lwd= 1.5, linetype= 1) +
geom_text(aes(label=mean_lab), color= "black", size= 2.7, vjust=-0.1) +
geom_text(aes(label=paste("\u00B1",se_lab)), color= "black", size= 2.2, vjust=1.5) +
scale_y_continuous(breaks=seq(-1,1,0.25), expand=c(0,0)) +
scale_x_discrete(labels= effect_labels) +
labs(title="Weights on Hypothesis Covariance Matrices") +
xlab("Magnitude") + ylab("Correlation") +
theme_pubclean() +
#theme(axis.text=element_text(size=9), axis.title = element_text(size=11), plot.title = element_text(size=14),
#     legend.position = "none") +
theme(axis.text=element_text(size=9), axis.title = element_text(size=11), plot.title = element_blank(),
legend.position = "none") +
scale_fill_gradient(low="gray98",high="#829ed9")
small <- ggplot(df_null, aes(x= 0, y= 0, fill= Mean)) +
geom_tile(color= "white", lwd= 1.5, linetype= 1) +
geom_text(aes(label=mean_lab), color= "white", size= 2.7, vjust=-0.1) +
geom_text(aes(label=paste("\u00B1",se_lab)), color= "white", size= 2.2, vjust=1.5) +
scale_y_continuous(expand=c(0,0)) +
ylab("Weight of \nNo Effect Matrix") +
theme_pubclean() +
theme(axis.text=element_blank(), axis.title=element_blank(),
axis.title.y = element_text(size=10, angle=360, vjust=0.5),
legend.position = "none",axis.ticks = element_blank(), plot.title = element_blank()) +
scale_fill_gradient(low="#2b62d9",high="#2b62d9")
lay <- rbind( c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(2,2,3,3,3))
p <- gridExtra::grid.arrange(big, small, ncol=1, layout_matrix=lay)
big <- ggplot(df_ave, aes(x= magnitude, y= correlation, fill= Mean)) +
geom_tile(color= "white", lwd= 1.5, linetype= 1) +
geom_text(aes(label=mean_lab), color= "black", size= 2.6, vjust=-0.1) +
geom_text(aes(label=paste("\u00B1",se_lab)), color= "black", size= 2.2, vjust=1.5) +
scale_y_continuous(breaks=seq(-1,1,0.25), expand=c(0,0)) +
scale_x_discrete(labels= effect_labels) +
labs(title="Weights on Hypothesis Covariance Matrices") +
xlab("Magnitude") + ylab("Correlation") +
theme_pubclean() +
#theme(axis.text=element_text(size=9), axis.title = element_text(size=11), plot.title = element_text(size=14),
#     legend.position = "none") +
theme(axis.text=element_text(size=9), axis.title = element_text(size=11), plot.title = element_blank(),
legend.position = "none") +
scale_fill_gradient(low="gray98",high="#829ed9")
small <- ggplot(df_null, aes(x= 0, y= 0, fill= Mean)) +
geom_tile(color= "white", lwd= 1.5, linetype= 1) +
geom_text(aes(label=mean_lab), color= "white", size= 2.6, vjust=-0.1) +
geom_text(aes(label=paste("\u00B1",se_lab)), color= "white", size= 2.2, vjust=1.5) +
scale_y_continuous(expand=c(0,0)) +
ylab("Weight of \nNo Effect Matrix") +
theme_pubclean() +
theme(axis.text=element_blank(), axis.title=element_blank(),
axis.title.y = element_text(size=10, angle=360, vjust=0.5),
legend.position = "none",axis.ticks = element_blank(), plot.title = element_blank()) +
scale_fill_gradient(low="#2b62d9",high="#2b62d9")
lay <- rbind( c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(2,2,3,3,3))
p <- gridExtra::grid.arrange(big, small, ncol=1, layout_matrix=lay)
big <- ggplot(df_ave, aes(x= magnitude, y= correlation, fill= Mean)) +
geom_tile(color= "white", lwd= 1.5, linetype= 1) +
geom_text(aes(label=mean_lab), color= "black", size= 2.7, vjust=-0.1) +
geom_text(aes(label=paste("\u00B1",se_lab)), color= "black", size= 2.2, vjust=1.5) +
scale_y_continuous(breaks=seq(-1,1,0.25), expand=c(0,0)) +
scale_x_discrete(labels= effect_labels) +
labs(title="Weights on Hypothesis Covariance Matrices") +
xlab("Magnitude") + ylab("Correlation") +
theme_pubclean() +
#theme(axis.text=element_text(size=9), axis.title = element_text(size=11), plot.title = element_text(size=14),
#     legend.position = "none") +
theme(axis.text=element_text(size=9), axis.title = element_text(size=11), plot.title = element_blank(),
legend.position = "none") +
scale_fill_gradient(low="gray98",high="#829ed9")
small <- ggplot(df_null, aes(x= 0, y= 0, fill= Mean)) +
geom_tile(color= "white", lwd= 1.5, linetype= 1) +
geom_text(aes(label=mean_lab), color= "white", size= 2.7, vjust=-0.1) +
geom_text(aes(label=paste("\u00B1",se_lab)), color= "white", size= 2.2, vjust=1.5) +
scale_y_continuous(expand=c(0,0)) +
ylab("Weight of \nNo Effect Matrix") +
theme_pubclean() +
theme(axis.text=element_blank(), axis.title=element_blank(),
axis.title.y = element_text(size=10, angle=360, vjust=0.5),
legend.position = "none",axis.ticks = element_blank(), plot.title = element_blank()) +
scale_fill_gradient(low="#2b62d9",high="#2b62d9")
lay <- rbind( c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(1,1,1,1,1), c(2,2,3,3,3))
p <- gridExtra::grid.arrange(big, small, ncol=1, layout_matrix=lay)
# get nice phenotype names
setwd("~/Research/GWAS-frontera/LDSC/")
ldsc_df <- read.csv("ldsc_results.txt", sep="\t", colClasses = c(rep("character",2), rep("NULL",5)))
ldsc_df <- unique(ldsc_df)
# get phenotypic variance by sex
setwd("~/Research/GWAS-frontera/Phenotypes")
pheno_vars <- read.csv("pheno_var.txt", sep="\t")
# get mash weights
setwd("~/Research/GWAS-frontera/mash/")
mash_weights <- read.csv("mash_weights.txt", sep="\t")
# create column of ratio of male to female phenotypic variance
pheno_vars <- pheno_vars %>%
merge(ldsc_df, by.x="pheno", by.y="Code") %>%
mutate(ratio_mf = m_var / f_var) %>%
select(c(1,6,7))
# create column of difference of male and female mash weights
mash_weights <- mash_weights %>%
mutate(diff_mf = sum_weight_m - sum_weight_f) %>%
select(c(1,6))
# combine phenotypic variance and mash weights df
df <- merge(pheno_vars, mash_weights, by.x = "pheno", by.y = "phenotype")
# split outliers (arm_fatfree_mass and testosterone)
df1 <- df[! df$pheno %in% c('arm_fatfree_mass_L', 'arm_fatfree_mass_R', 'testosterone'),]
df2 <- df[df$pheno %in% c('arm_fatfree_mass_L', 'arm_fatfree_mass_R'),]
df3 <- df[df$pheno == 'testosterone',]
empty_df <- data.frame()
anno_size=2.8
# scatter plot
g1 <- ggplot(empty_df) + geom_point() +
geom_hline(yintercept = 27.6) +
geom_vline(xintercept = 0, linetype="dashed", alpha = 0.5) +
scale_x_continuous(breaks=seq(-60,60,20), limits=c(-75,65), expand=c(0,0)) +
scale_y_continuous(breaks=c(27.2,27.4), limits=c(27,27.6), expand=c(0,0)) +
theme_classic() +
theme(axis.title=element_blank(), axis.text.x=element_blank(), axis.text.y = element_text(size=10),
axis.ticks.x=element_blank(), axis.line.x.bottom = element_blank())
g2 <- ggplot(data=df3, aes(x= diff_mf, y= ratio_mf)) +
geom_point(size=2, color='#2b62d9') +
geom_hline(yintercept = 27.6) + geom_vline(xintercept = 100) +
scale_x_continuous(breaks=c(85,90,95), limits=c(80,100), expand=c(0,0)) +
scale_y_continuous(breaks=c(27.2,27.4), limits=c(27,27.6), expand=c(0,0)) +
theme_classic() +
theme(axis.title=element_blank(), axis.text=element_blank(), axis.ticks=element_blank(),
axis.line=element_blank()) +
geom_text_repel(aes(label=Phenotype), size=anno_size)
g3 <- ggplot(data=df1, aes(x= diff_mf, y= ratio_mf)) +
geom_point(size=2, color='#2b62d9') +
geom_hline(yintercept = 1, linetype="dashed", alpha = 0.5) +
geom_vline(xintercept = 0, linetype="dashed", alpha = 0.5) +
scale_x_continuous(breaks=seq(-60,60,20), limits=c(-75,65), expand=c(0,0)) +
scale_y_continuous(breaks=c(1,2,3), limits=c(0,3.5), expand=c(0,0)) +
theme_classic2() +
theme(axis.title=element_blank(), legend.position = "none", axis.text.x = element_text(size=10)) +
geom_text_repel(aes(label=Phenotype), size=anno_size, max.overlaps = Inf, box.padding=0.7)
g4 <- ggplot(df2, aes(x= diff_mf, y= ratio_mf)) +
geom_point(size=2, color='#2b62d9') +
geom_vline(xintercept = 100) +
geom_hline(yintercept = 1, linetype="dashed", alpha = 0.5) +
scale_x_continuous(breaks=c(85,90,95), limits=c(80,100), expand=c(0,0)) +
scale_y_continuous(breaks=c(1,2,3), limits=c(0,3.5), expand=c(0,0)) +
theme_classic() +
theme(axis.title=element_blank(), axis.text.y=element_blank(), axis.text.x = element_text(size=10),
axis.ticks.y=element_blank(), axis.line.y = element_blank()) +
geom_text_repel(aes(label=Phenotype), size=anno_size) +
coord_cartesian(clip="off")
gA <- ggplotGrob(g1) ; gB <- ggplotGrob(g3)
maxWidth = grid::unit.pmax(gA$widths[2:5], gB$widths[2:5])
gA$widths[2:5] <- as.list(maxWidth) ; gB$widths[2:5] <- as.list(maxWidth)
plot <- grid.arrange(gA, g2, gB, g4, ncol=2, nrow=2, widths=c(5,1), heights=c(1,4))
annotate_figure(plot,
bottom = text_grob("Difference between fractions of variants with M>F and M<F effect", size=12),
left = text_grob("Ratio of Male to Female Phenotypic Variance", size=12, rot=90),
top = text_grob("Phenotypic Variance Strongly Correlated with Amplification", size = 16))
# get nice phenotype names
setwd("~/Research/GWAS-frontera/LDSC/")
ldsc_df <- read.csv("ldsc_results.txt", sep="\t", colClasses = c(rep("character",2), rep("NULL",5)))
ldsc_df <- unique(ldsc_df)
# get phenotypic variance by sex
setwd("~/Research/GWAS-frontera/Phenotypes")
pheno_vars <- read.csv("pheno_var.txt", sep="\t")
# get mash weights
setwd("~/Research/GWAS-frontera/mash/")
mash_weights <- read.csv("mash_weights.txt", sep="\t")
# create column of ratio of male to female phenotypic variance
pheno_vars <- pheno_vars %>%
merge(ldsc_df, by.x="pheno", by.y="Code") %>%
mutate(ratio_mf = m_var / f_var) %>%
select(c(1,6,7))
# create column of difference of male and female mash weights
mash_weights <- mash_weights %>%
mutate(diff_mf = sum_weight_m - sum_weight_f) %>%
select(c(1,6))
# combine phenotypic variance and mash weights df
df <- merge(pheno_vars, mash_weights, by.x = "pheno", by.y = "phenotype")
# split outliers (arm_fatfree_mass and testosterone)
df1 <- df[! df$pheno %in% c('arm_fatfree_mass_L', 'arm_fatfree_mass_R', 'testosterone'),]
df2 <- df[df$pheno %in% c('arm_fatfree_mass_L', 'arm_fatfree_mass_R'),]
df3 <- df[df$pheno == 'testosterone',]
df3
empty_df <- data.frame()
anno_size=2.8
# scatter plot
g1 <- ggplot(empty_df) + geom_point() +
geom_hline(yintercept = 27.6) +
geom_vline(xintercept = 0, linetype="dashed", alpha = 0.5) +
scale_x_continuous(breaks=seq(-60,60,20), limits=c(-75,65), expand=c(0,0)) +
scale_y_continuous(breaks=c(27.2,27.4), limits=c(27,27.6), expand=c(0,0)) +
theme_classic() +
theme(axis.title=element_blank(), axis.text.x=element_blank(), axis.text.y = element_text(size=10),
axis.ticks.x=element_blank(), axis.line.x.bottom = element_blank())
g2 <- ggplot(data=df3, aes(x= diff_mf, y= ratio_mf)) +
geom_point(size=2, color='#2b62d9') +
geom_hline(yintercept = 27.6) + geom_vline(xintercept = 100) +
scale_x_continuous(breaks=c(85,90,95), limits=c(80,100), expand=c(0,0)) +
scale_y_continuous(breaks=c(27.2,27.4), limits=c(27,27.6), expand=c(0,0)) +
theme_classic() +
theme(axis.title=element_blank(), axis.text=element_blank(), axis.ticks=element_blank(),
axis.line=element_blank()) +
geom_text_repel(aes(label=Phenotype), size=anno_size)
library(ggrepel)
g2 <- ggplot(data=df3, aes(x= diff_mf, y= ratio_mf)) +
geom_point(size=2, color='#2b62d9') +
geom_hline(yintercept = 27.6) + geom_vline(xintercept = 100) +
scale_x_continuous(breaks=c(85,90,95), limits=c(80,100), expand=c(0,0)) +
scale_y_continuous(breaks=c(27.2,27.4), limits=c(27,27.6), expand=c(0,0)) +
theme_classic() +
theme(axis.title=element_blank(), axis.text=element_blank(), axis.ticks=element_blank(),
axis.line=element_blank()) +
geom_text_repel(aes(label=Phenotype), size=anno_size)
g3 <- ggplot(data=df1, aes(x= diff_mf, y= ratio_mf)) +
geom_point(size=2, color='#2b62d9') +
geom_hline(yintercept = 1, linetype="dashed", alpha = 0.5) +
geom_vline(xintercept = 0, linetype="dashed", alpha = 0.5) +
scale_x_continuous(breaks=seq(-60,60,20), limits=c(-75,65), expand=c(0,0)) +
scale_y_continuous(breaks=c(1,2,3), limits=c(0,3.5), expand=c(0,0)) +
theme_classic2() +
theme(axis.title=element_blank(), legend.position = "none", axis.text.x = element_text(size=10)) +
geom_text_repel(aes(label=Phenotype), size=anno_size, max.overlaps = Inf, box.padding=0.7)
g4 <- ggplot(df2, aes(x= diff_mf, y= ratio_mf)) +
geom_point(size=2, color='#2b62d9') +
geom_vline(xintercept = 100) +
geom_hline(yintercept = 1, linetype="dashed", alpha = 0.5) +
scale_x_continuous(breaks=c(85,90,95), limits=c(80,100), expand=c(0,0)) +
scale_y_continuous(breaks=c(1,2,3), limits=c(0,3.5), expand=c(0,0)) +
theme_classic() +
theme(axis.title=element_blank(), axis.text.y=element_blank(), axis.text.x = element_text(size=10),
axis.ticks.y=element_blank(), axis.line.y = element_blank()) +
geom_text_repel(aes(label=Phenotype), size=anno_size) +
coord_cartesian(clip="off")
gA <- ggplotGrob(g1) ; gB <- ggplotGrob(g3)
maxWidth = grid::unit.pmax(gA$widths[2:5], gB$widths[2:5])
gA$widths[2:5] <- as.list(maxWidth) ; gB$widths[2:5] <- as.list(maxWidth)
plot <- grid.arrange(gA, g2, gB, g4, ncol=2, nrow=2, widths=c(5,1), heights=c(1,4))
annotate_figure(plot,
bottom = text_grob("Difference between fractions of variants with M>F and M<F effect", size=12),
left = text_grob("Ratio of Male to Female Phenotypic Variance", size=12, rot=90),
top = text_grob("Phenotypic Variance Strongly Correlated with Amplification", size = 16))
g3 <- ggplot(data=df1, aes(x= diff_mf, y= ratio_mf)) +
geom_point(size=2, color='#2b62d9') +
geom_hline(yintercept = 1, linetype="dashed", alpha = 0.5) +
geom_vline(xintercept = 0, linetype="dashed", alpha = 0.5) +
geom_abline(slope = 1, intercept = 0, color="gray", size=0.8) +
scale_x_continuous(breaks=seq(-60,60,20), limits=c(-75,65), expand=c(0,0)) +
scale_y_continuous(breaks=c(1,2,3), limits=c(0,3.5), expand=c(0,0)) +
theme_classic2() +
theme(axis.title=element_blank(), legend.position = "none", axis.text.x = element_text(size=10)) +
geom_text_repel(aes(label=Phenotype), size=anno_size, max.overlaps = Inf, box.padding=0.7)
g4 <- ggplot(df2, aes(x= diff_mf, y= ratio_mf)) +
geom_point(size=2, color='#2b62d9') +
geom_vline(xintercept = 100) +
geom_hline(yintercept = 1, linetype="dashed", alpha = 0.5) +
scale_x_continuous(breaks=c(85,90,95), limits=c(80,100), expand=c(0,0)) +
scale_y_continuous(breaks=c(1,2,3), limits=c(0,3.5), expand=c(0,0)) +
theme_classic() +
theme(axis.title=element_blank(), axis.text.y=element_blank(), axis.text.x = element_text(size=10),
axis.ticks.y=element_blank(), axis.line.y = element_blank()) +
geom_text_repel(aes(label=Phenotype), size=anno_size) +
coord_cartesian(clip="off")
gA <- ggplotGrob(g1) ; gB <- ggplotGrob(g3)
maxWidth = grid::unit.pmax(gA$widths[2:5], gB$widths[2:5])
gA$widths[2:5] <- as.list(maxWidth) ; gB$widths[2:5] <- as.list(maxWidth)
plot <- grid.arrange(gA, g2, gB, g4, ncol=2, nrow=2, widths=c(5,1), heights=c(1,4))
annotate_figure(plot,
bottom = text_grob("Difference between fractions of variants with M>F and M<F effect", size=12),
left = text_grob("Ratio of Male to Female Phenotypic Variance", size=12, rot=90),
top = text_grob("Phenotypic Variance Strongly Correlated with Amplification", size = 16))
df_corr <- df[df$pheno != 'testosterone',]
model <- cor.test(df_corr$diff_mf, df_corr$ratio_mf)
model
model <- lm(ratio_mf ~ diff_mf, df_corr)
model
summary(model)
model <- cor.test(df_corr$diff_mf, df_corr$ratio_mf)
summary(model)
model
nrow(df)
nrow(df_corr)
5.8e-9
10^-9
model <- lm(ratio_mf ~ diff_mf, df_corr)
summary(model)
sqrt(0.7626)
g3 <- ggplot(data=df1, aes(x= diff_mf, y= ratio_mf)) +
geom_point(size=2, color='#2b62d9') +
geom_hline(yintercept = 1, linetype="dashed", alpha = 0.5) +
geom_vline(xintercept = 0, linetype="dashed", alpha = 0.5) +
geom_abline(slope = 0.014007, intercept = 1.220738, color="gray", size=0.8) +
scale_x_continuous(breaks=seq(-60,60,20), limits=c(-75,65), expand=c(0,0)) +
scale_y_continuous(breaks=c(1,2,3), limits=c(0,3.5), expand=c(0,0)) +
theme_classic2() +
theme(axis.title=element_blank(), legend.position = "none", axis.text.x = element_text(size=10)) +
geom_text_repel(aes(label=Phenotype), size=anno_size, max.overlaps = Inf, box.padding=0.7)
g4 <- ggplot(df2, aes(x= diff_mf, y= ratio_mf)) +
geom_point(size=2, color='#2b62d9') +
geom_vline(xintercept = 100) +
geom_hline(yintercept = 1, linetype="dashed", alpha = 0.5) +
scale_x_continuous(breaks=c(85,90,95), limits=c(80,100), expand=c(0,0)) +
scale_y_continuous(breaks=c(1,2,3), limits=c(0,3.5), expand=c(0,0)) +
theme_classic() +
theme(axis.title=element_blank(), axis.text.y=element_blank(), axis.text.x = element_text(size=10),
axis.ticks.y=element_blank(), axis.line.y = element_blank()) +
geom_text_repel(aes(label=Phenotype), size=anno_size) +
coord_cartesian(clip="off")
gA <- ggplotGrob(g1) ; gB <- ggplotGrob(g3)
maxWidth = grid::unit.pmax(gA$widths[2:5], gB$widths[2:5])
gA$widths[2:5] <- as.list(maxWidth) ; gB$widths[2:5] <- as.list(maxWidth)
plot <- grid.arrange(gA, g2, gB, g4, ncol=2, nrow=2, widths=c(5,1), heights=c(1,4))
annotate_figure(plot,
bottom = text_grob("Difference between fractions of variants with M>F and M<F effect", size=12),
left = text_grob("Ratio of Male to Female Phenotypic Variance", size=12, rot=90),
top = text_grob("Phenotypic Variance Strongly Correlated with Amplification", size = 16))
g4 <- ggplot(df2, aes(x= diff_mf, y= ratio_mf)) +
geom_point(size=2, color='#2b62d9') +
geom_vline(xintercept = 100) +
geom_hline(yintercept = 1, linetype="dashed", alpha = 0.5) +
geom_abline(slope = 0.014007, intercept = 1.220738, color="gray", size=0.8) +
scale_x_continuous(breaks=c(85,90,95), limits=c(80,100), expand=c(0,0)) +
scale_y_continuous(breaks=c(1,2,3), limits=c(0,3.5), expand=c(0,0)) +
theme_classic() +
theme(axis.title=element_blank(), axis.text.y=element_blank(), axis.text.x = element_text(size=10),
axis.ticks.y=element_blank(), axis.line.y = element_blank()) +
geom_text_repel(aes(label=Phenotype), size=anno_size) +
coord_cartesian(clip="off")
gA <- ggplotGrob(g1) ; gB <- ggplotGrob(g3)
maxWidth = grid::unit.pmax(gA$widths[2:5], gB$widths[2:5])
gA$widths[2:5] <- as.list(maxWidth) ; gB$widths[2:5] <- as.list(maxWidth)
plot <- grid.arrange(gA, g2, gB, g4, ncol=2, nrow=2, widths=c(5,1), heights=c(1,4))
annotate_figure(plot,
bottom = text_grob("Difference between fractions of variants with M>F and M<F effect", size=12),
left = text_grob("Ratio of Male to Female Phenotypic Variance", size=12, rot=90),
top = text_grob("Phenotypic Variance Strongly Correlated with Amplification", size = 16))
