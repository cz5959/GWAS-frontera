geom_hline(yintercept = 25.7) +
scale_x_continuous(breaks=c(3,3.4,3.8), limits=c(3,3.9), expand=c(0,0)) +
scale_y_continuous(breaks=seq(23,25,1), limits=c(22.47,25.7), expand=c(0,0)) +
theme_classic() +
theme(axis.text=element_blank(), axis.title=element_blank(), axis.ticks=element_blank(),
axis.line = element_blank())
g3 <- ggplot(data=df3, aes(x= geno_var_ratio, y= env_var_ratio)) +
geom_hline(yintercept = 25.7) + geom_vline(xintercept = 108) +
geom_point(size=2, alpha=0.5) +
geom_errorbar(aes(y=env_var_ratio, ymin=env_var_ratio-2*env_var_ratio_se, ymax=env_var_ratio+2*env_var_ratio_se), width=0) +
geom_errorbarh(aes(y=env_var_ratio, xmin=geno_var_ratio-2*geno_var_ratio_se, xmax=geno_var_ratio+2*geno_var_ratio_se), height=0) +
scale_y_continuous(breaks=seq(23,25,1), limits=c(22.47,25.7), expand=c(0,0)) +
scale_x_continuous(breaks=seq(60,100,20), limits=c(51,108), expand=c(0,0)) +
theme_classic() +
theme(axis.text=element_blank(), axis.title=element_blank(), axis.ticks=element_blank(),
axis.line=element_blank()) +
geom_text(aes(label=pheno_name), size=anno_size,x=75,y=24) +
coord_cartesian(clip = "off")
g4 <- ggplot(data=df1, aes(x= geno_var_ratio, y= env_var_ratio, color=on)) +
geom_point(size=2, alpha=0.5) +
geom_abline(slope = 1, intercept = 0, color=pcolor, size=0.8) +
geom_errorbar(aes(y=env_var_ratio, ymin=env_var_ratio-2*env_var_ratio_se, ymax=env_var_ratio+2*env_var_ratio_se),
width=0) +
geom_errorbarh(aes(y=env_var_ratio, xmin=geno_var_ratio-2*geno_var_ratio_se, xmax=geno_var_ratio+2*geno_var_ratio_se),
height=0) +
scale_y_continuous(breaks=c(1,2,3), limits=c(0,3.5), expand=c(0,0)) +
scale_x_continuous(breaks=seq(0.5, 2, 0.5), limits=c(0,2.3), expand=c(0,0)) +
theme_classic() +
theme(axis.text.x = element_text(size=10), axis.title=element_blank(), legend.position = "none") +
scale_color_continuous(low = "black", high = pcolor) +
geom_text_repel(data=(df1_1), aes(label=pheno_name, fontface = on), size=anno_size, max.overlaps=Inf, segment.alpha=0.5,
ylim=c(1.5,NA), box.padding=1.5, segment.linetype=2) +
geom_text_repel(data=(df1_2), aes(label=pheno_name, fontface = on), size=anno_size, max.overlaps=Inf, segment.alpha=0.5,
ylim=c(NA,0.9), box.padding=1.5, segment.linetype=2)
g5 <- ggplot(data=df2, aes(x= geno_var_ratio, y= env_var_ratio)) +
geom_point(size=2, alpha=0.5) +
geom_abline(slope = 1, intercept = 0, color=pcolor, size= 0.8) +
geom_errorbar(aes(y=env_var_ratio, ymin=env_var_ratio-env_var_ratio_se,
ymax=env_var_ratio+env_var_ratio_se), width=0) +
geom_errorbarh(aes(y=env_var_ratio, xmin=geno_var_ratio-geno_var_ratio_se, xmax=geno_var_ratio+geno_var_ratio_se),
height=0) +
scale_x_continuous(breaks=c(3,3.4,3.8), limits=c(3,3.9), expand=c(0,0)) +
scale_y_continuous(breaks=c(1,2,3), limits=c(0,3.5), expand=c(0,0)) +
theme_classic() +
theme(axis.text.y=element_blank(), axis.text.x = element_text(size=10), axis.title=element_blank(),
axis.ticks.y=element_blank(), axis.line.y = element_blank()) +
geom_text_repel(aes(label=pheno_name), size=anno_size, max.overlaps=Inf, segment.alpha=0, segment.linetype=2) +
annotate("text", x=3.3, y=2.3, label = "1:1 Relationship", color= pcolor) +
coord_cartesian(clip = "off")
g6 <- ggplot(empty_df) + geom_point() +
geom_vline(xintercept = 108) +
scale_x_continuous(breaks=seq(60,100,20), limits=c(51,108), expand=c(0,0)) +
scale_y_continuous(breaks=c(1,2,3), limits=c(0,3.5), expand=c(0,0)) +
theme_classic() +
theme(axis.text.y=element_blank(), axis.text.x = element_text(size=10), axis.title=element_blank(),
axis.ticks.y=element_blank(), axis.line.y = element_blank())
gA <- ggplotGrob(g1) ; gB <- ggplotGrob(g4)
maxWidth = grid::unit.pmax(gA$widths[2:5], gB$widths[2:5])
gA$widths[2:5] <- as.list(maxWidth) ; gB$widths[2:5] <- as.list(maxWidth)
plot <- grid.arrange(gA, g2, g3, gB, g5, g6, ncol=3, nrow=2, widths=c(6,2,1), heights=c(1,4))
annotate_figure(plot,
bottom = text_grob("Genetic Variance Male:Female Ratio", size=12),
left = text_grob("Environmental Variance Male:Female Ratio", size=12, rot=90),
top = text_grob("Genetic and Environmental Variance \n Relationship between Males and Females", face = "bold", size = 16))
g5 <- ggplot(data=df2, aes(x= geno_var_ratio, y= env_var_ratio)) +
geom_point(size=2, alpha=0.5) +
geom_abline(slope = 1, intercept = 0, color=pcolor, size= 0.8) +
geom_errorbar(aes(y=env_var_ratio, ymin=env_var_ratio-2*env_var_ratio_se,
ymax=env_var_ratio+2*env_var_ratio_se), width=0) +
geom_errorbarh(aes(y=env_var_ratio, xmin=geno_var_ratio-2*geno_var_ratio_se, xmax=geno_var_ratio+2*geno_var_ratio_se),
height=0) +
scale_x_continuous(breaks=c(3,3.4,3.8), limits=c(3,3.9), expand=c(0,0)) +
scale_y_continuous(breaks=c(1,2,3), limits=c(0,3.5), expand=c(0,0)) +
theme_classic() +
theme(axis.text.y=element_blank(), axis.text.x = element_text(size=10), axis.title=element_blank(),
axis.ticks.y=element_blank(), axis.line.y = element_blank()) +
geom_text_repel(aes(label=pheno_name), size=anno_size, max.overlaps=Inf, segment.alpha=0, segment.linetype=2) +
annotate("text", x=3.3, y=2.3, label = "1:1 Relationship", color= pcolor) +
coord_cartesian(clip = "off")
g5
df2
g5 <- ggplot(data=df2, aes(x= geno_var_ratio, y= env_var_ratio)) +
geom_point(size=2, alpha=0.5) +
geom_abline(slope = 1, intercept = 0, color=pcolor, size= 0.8) +
geom_errorbar(aes(y=env_var_ratio, ymin=env_var_ratio-2*env_var_ratio_se,
ymax=env_var_ratio+2*env_var_ratio_se), width=0) +
geom_errorbarh(aes(y=env_var_ratio, xmin=geno_var_ratio-2*geno_var_ratio_se, xmax=geno_var_ratio+2*geno_var_ratio_se),
height=0) +
scale_x_continuous(breaks=c(3,3.4,3.8), limits=c(3,4.2), expand=c(0,0)) +
scale_y_continuous(breaks=c(1,2,3), limits=c(0,3.5), expand=c(0,0)) +
theme_classic() +
theme(axis.text.y=element_blank(), axis.text.x = element_text(size=10), axis.title=element_blank(),
axis.ticks.y=element_blank(), axis.line.y = element_blank()) +
geom_text_repel(aes(label=pheno_name), size=anno_size, max.overlaps=Inf, segment.alpha=0, segment.linetype=2) +
annotate("text", x=3.3, y=2.3, label = "1:1 Relationship", color= pcolor) +
coord_cartesian(clip = "off")
g5
df2
g5 <- ggplot(data=df2, aes(x= geno_var_ratio, y= env_var_ratio)) +
geom_point(size=2, alpha=0.5) +
geom_abline(slope = 1, intercept = 0, color=pcolor, size= 0.8) +
geom_errorbar(aes(y=env_var_ratio, ymin=env_var_ratio-2*env_var_ratio_se,
ymax=env_var_ratio+2*env_var_ratio_se), width=0) +
geom_errorbarh(aes(y=env_var_ratio, xmin=geno_var_ratio-2*geno_var_ratio_se, xmax=geno_var_ratio+2*geno_var_ratio_se),
height=0) +
scale_x_continuous(breaks=c(3,3.4,3.8), limits=c(2.8,4.2), expand=c(0,0)) +
scale_y_continuous(breaks=c(1,2,3), limits=c(0,3.5), expand=c(0,0)) +
theme_classic() +
theme(axis.text.y=element_blank(), axis.text.x = element_text(size=10), axis.title=element_blank(),
axis.ticks.y=element_blank(), axis.line.y = element_blank()) +
geom_text_repel(aes(label=pheno_name), size=anno_size, max.overlaps=Inf, segment.alpha=0, segment.linetype=2) +
annotate("text", x=3.3, y=2.3, label = "1:1 Relationship", color= pcolor) +
coord_cartesian(clip = "off")
g5
g5 <- ggplot(data=df2, aes(x= geno_var_ratio, y= env_var_ratio)) +
geom_point(size=2, alpha=0.5) +
geom_abline(slope = 1, intercept = 0, color=pcolor, size= 0.8) +
geom_errorbar(aes(y=env_var_ratio, ymin=env_var_ratio-2*env_var_ratio_se,
ymax=env_var_ratio+2*env_var_ratio_se), width=0) +
geom_errorbarh(aes(y=env_var_ratio, xmin=geno_var_ratio-2*geno_var_ratio_se, xmax=geno_var_ratio+2*geno_var_ratio_se),
height=0) +
scale_x_continuous(breaks=c(3,3.4,3.8), limits=c(2.7,4.2), expand=c(0,0)) +
scale_y_continuous(breaks=c(1,2,3), limits=c(0,3.5), expand=c(0,0)) +
theme_classic() +
theme(axis.text.y=element_blank(), axis.text.x = element_text(size=10), axis.title=element_blank(),
axis.ticks.y=element_blank(), axis.line.y = element_blank()) +
geom_text_repel(aes(label=pheno_name), size=anno_size, max.overlaps=Inf, segment.alpha=0, segment.linetype=2) +
annotate("text", x=3.3, y=2.3, label = "1:1 Relationship", color= pcolor) +
coord_cartesian(clip = "off")
g5
g5 <- ggplot(data=df2, aes(x= geno_var_ratio, y= env_var_ratio)) +
geom_point(size=2, alpha=0.5) +
geom_abline(slope = 1, intercept = 0, color=pcolor, size= 0.8) +
geom_errorbar(aes(y=env_var_ratio, ymin=env_var_ratio-2*env_var_ratio_se,
ymax=env_var_ratio+2*env_var_ratio_se), width=0) +
geom_errorbarh(aes(y=env_var_ratio, xmin=geno_var_ratio-2*geno_var_ratio_se, xmax=geno_var_ratio+2*geno_var_ratio_se),
height=0) +
scale_x_continuous(breaks=seq(3,4,0.5), limits=c(2.7,4.2), expand=c(0,0)) +
scale_y_continuous(breaks=c(1,2,3), limits=c(0,3.5), expand=c(0,0)) +
theme_classic() +
theme(axis.text.y=element_blank(), axis.text.x = element_text(size=10), axis.title=element_blank(),
axis.ticks.y=element_blank(), axis.line.y = element_blank()) +
geom_text_repel(aes(label=pheno_name), size=anno_size, max.overlaps=Inf, segment.alpha=0, segment.linetype=2) +
annotate("text", x=3.3, y=2.3, label = "1:1 Relationship", color= pcolor) +
coord_cartesian(clip = "off")
g5
g1 <- ggplot(empty_df) + geom_point() +
geom_hline(yintercept = 25.7) +
scale_y_continuous(breaks=seq(23,25,1), limits=c(22.47,25.7), expand=c(0,0)) +
scale_x_continuous(breaks=seq(0.5, 2, 0.5), limits=c(0,2.3), expand=c(0,0)) +
theme_classic() +
theme(axis.text.x=element_blank(), axis.text.y = element_text(size=10), axis.title=element_blank(),
axis.ticks.x=element_blank(), axis.line.x = element_blank()) +
annotate("text", x = 0.5, y = 24.5, label= "Consistent with 1:1 Relationship", hjust = 0, color = pcolor) +
annotate("text", x = 0.5, y = 23.5, label= "Deviates from 1:1 Relationship", hjust = 0)
g2 <- ggplot(empty_df) + geom_point() +
geom_hline(yintercept = 25.7) +
scale_x_continuous(breaks=seq(3,4,0.5), limits=c(2.7,4.2), expand=c(0,0)) +
scale_y_continuous(breaks=seq(23,25,1), limits=c(22.47,25.7), expand=c(0,0)) +
theme_classic() +
theme(axis.text=element_blank(), axis.title=element_blank(), axis.ticks=element_blank(),
axis.line = element_blank())
g3 <- ggplot(data=df3, aes(x= geno_var_ratio, y= env_var_ratio)) +
geom_hline(yintercept = 25.7) + geom_vline(xintercept = 108) +
geom_point(size=2, alpha=0.5) +
geom_errorbar(aes(y=env_var_ratio, ymin=env_var_ratio-2*env_var_ratio_se, ymax=env_var_ratio+2*env_var_ratio_se), width=0) +
geom_errorbarh(aes(y=env_var_ratio, xmin=geno_var_ratio-2*geno_var_ratio_se, xmax=geno_var_ratio+2*geno_var_ratio_se), height=0) +
scale_y_continuous(breaks=seq(23,25,1), limits=c(22.47,25.7), expand=c(0,0)) +
scale_x_continuous(breaks=seq(60,100,20), limits=c(51,108), expand=c(0,0)) +
theme_classic() +
theme(axis.text=element_blank(), axis.title=element_blank(), axis.ticks=element_blank(),
axis.line=element_blank()) +
geom_text(aes(label=pheno_name), size=anno_size,x=75,y=24) +
coord_cartesian(clip = "off")
g4 <- ggplot(data=df1, aes(x= geno_var_ratio, y= env_var_ratio, color=on)) +
geom_point(size=2, alpha=0.5) +
geom_abline(slope = 1, intercept = 0, color=pcolor, size=0.8) +
geom_errorbar(aes(y=env_var_ratio, ymin=env_var_ratio-2*env_var_ratio_se, ymax=env_var_ratio+2*env_var_ratio_se),
width=0) +
geom_errorbarh(aes(y=env_var_ratio, xmin=geno_var_ratio-2*geno_var_ratio_se, xmax=geno_var_ratio+2*geno_var_ratio_se),
height=0) +
scale_y_continuous(breaks=c(1,2,3), limits=c(0,3.5), expand=c(0,0)) +
scale_x_continuous(breaks=seq(0.5, 2, 0.5), limits=c(0,2.3), expand=c(0,0)) +
theme_classic() +
theme(axis.text.x = element_text(size=10), axis.title=element_blank(), legend.position = "none") +
scale_color_continuous(low = "black", high = pcolor) +
geom_text_repel(data=(df1_1), aes(label=pheno_name, fontface = on), size=anno_size, max.overlaps=Inf, segment.alpha=0.5,
ylim=c(1.5,NA), box.padding=1.5, segment.linetype=2) +
geom_text_repel(data=(df1_2), aes(label=pheno_name, fontface = on), size=anno_size, max.overlaps=Inf, segment.alpha=0.5,
ylim=c(NA,0.9), box.padding=1.5, segment.linetype=2)
g5 <- ggplot(data=df2, aes(x= geno_var_ratio, y= env_var_ratio)) +
geom_point(size=2, alpha=0.5) +
geom_abline(slope = 1, intercept = 0, color=pcolor, size= 0.8) +
geom_errorbar(aes(y=env_var_ratio, ymin=env_var_ratio-2*env_var_ratio_se,
ymax=env_var_ratio+2*env_var_ratio_se), width=0) +
geom_errorbarh(aes(y=env_var_ratio, xmin=geno_var_ratio-2*geno_var_ratio_se, xmax=geno_var_ratio+2*geno_var_ratio_se),
height=0) +
scale_x_continuous(breaks=seq(3,4,0.5), limits=c(2.7,4.2), expand=c(0,0)) +
scale_y_continuous(breaks=c(1,2,3), limits=c(0,3.5), expand=c(0,0)) +
theme_classic() +
theme(axis.text.y=element_blank(), axis.text.x = element_text(size=10), axis.title=element_blank(),
axis.ticks.y=element_blank(), axis.line.y = element_blank()) +
geom_text_repel(aes(label=pheno_name), size=anno_size, max.overlaps=Inf, segment.alpha=0, segment.linetype=2) +
annotate("text", x=3.3, y=2.3, label = "1:1 Relationship", color= pcolor) +
coord_cartesian(clip = "off")
g6 <- ggplot(empty_df) + geom_point() +
geom_vline(xintercept = 108) +
scale_x_continuous(breaks=seq(60,100,20), limits=c(51,108), expand=c(0,0)) +
scale_y_continuous(breaks=c(1,2,3), limits=c(0,3.5), expand=c(0,0)) +
theme_classic() +
theme(axis.text.y=element_blank(), axis.text.x = element_text(size=10), axis.title=element_blank(),
axis.ticks.y=element_blank(), axis.line.y = element_blank())
gA <- ggplotGrob(g1) ; gB <- ggplotGrob(g4)
maxWidth = grid::unit.pmax(gA$widths[2:5], gB$widths[2:5])
gA$widths[2:5] <- as.list(maxWidth) ; gB$widths[2:5] <- as.list(maxWidth)
plot <- grid.arrange(gA, g2, g3, gB, g5, g6, ncol=3, nrow=2, widths=c(6,2,1), heights=c(1,4))
annotate_figure(plot,
bottom = text_grob("Genetic Variance Male:Female Ratio", size=12),
left = text_grob("Environmental Variance Male:Female Ratio", size=12, rot=90),
top = text_grob("Genetic and Environmental Variance \n Relationship between Males and Females", face = "bold", size = 16))
g5 <- ggplot(data=df2, aes(x= geno_var_ratio, y= env_var_ratio)) +
geom_point(size=2, alpha=0.5) +
geom_abline(slope = 1, intercept = 0, color=pcolor, size= 0.8) +
geom_errorbar(aes(y=env_var_ratio, ymin=env_var_ratio-2*env_var_ratio_se,
ymax=env_var_ratio+2*env_var_ratio_se), width=0) +
geom_errorbarh(aes(y=env_var_ratio, xmin=geno_var_ratio-2*geno_var_ratio_se, xmax=geno_var_ratio+2*geno_var_ratio_se),
height=0) +
scale_x_continuous(breaks=seq(3,4,0.5), limits=c(2.7,4.2), expand=c(0,0)) +
scale_y_continuous(breaks=c(1,2,3), limits=c(0,3.5), expand=c(0,0)) +
theme_classic() +
theme(axis.text.y=element_blank(), axis.text.x = element_text(size=10), axis.title=element_blank(),
axis.ticks.y=element_blank(), axis.line.y = element_blank()) +
geom_text_repel(aes(label=pheno_name), size=anno_size, max.overlaps=Inf, segment.alpha=0, segment.linetype=2) +
annotate("text", x=3.3, y=2.3, label = "1:1 Relationship", color= pcolor)
g6 <- ggplot(empty_df) + geom_point() +
geom_vline(xintercept = 108) +
scale_x_continuous(breaks=seq(60,100,20), limits=c(51,108), expand=c(0,0)) +
scale_y_continuous(breaks=c(1,2,3), limits=c(0,3.5), expand=c(0,0)) +
theme_classic() +
theme(axis.text.y=element_blank(), axis.text.x = element_text(size=10), axis.title=element_blank(),
axis.ticks.y=element_blank(), axis.line.y = element_blank())
gA <- ggplotGrob(g1) ; gB <- ggplotGrob(g4)
maxWidth = grid::unit.pmax(gA$widths[2:5], gB$widths[2:5])
gA$widths[2:5] <- as.list(maxWidth) ; gB$widths[2:5] <- as.list(maxWidth)
plot <- grid.arrange(gA, g2, g3, gB, g5, g6, ncol=3, nrow=2, widths=c(6,2,1), heights=c(1,4))
annotate_figure(plot,
bottom = text_grob("Genetic Variance Male:Female Ratio", size=12),
left = text_grob("Environmental Variance Male:Female Ratio", size=12, rot=90),
top = text_grob("Genetic and Environmental Variance \n Relationship between Males and Females", face = "bold", size = 16))
##################### 4 SE
pcolor = '#2b62d9'
df <- mutate(df, on = ifelse(abs(env_var_ratio-geno_var_ratio) <= 2*env_var_ratio_se |
abs(geno_var_ratio-env_var_ratio) <= 2*geno_var_ratio_se, 2,1))
df1 <- df[! df$pheno %in% c('arm_fatfree_mass_L', 'arm_fatfree_mass_R', 'testosterone'),]
df1_1 <- df1[(df1$env_var_ratio/df1$geno_var_ratio) >=1,]
df1_2 <- df1[df1$env_var_ratio/df1$geno_var_ratio <1,]
df2 <- df[df$pheno %in% c('arm_fatfree_mass_L', 'arm_fatfree_mass_R'),]
df3 <- df[df$pheno == 'testosterone',]
empty_df <- data.frame()
anno_size = 2.8
g1 <- ggplot(empty_df) + geom_point() +
geom_hline(yintercept = 25.7) +
scale_y_continuous(breaks=seq(23,25,1), limits=c(22.47,25.7), expand=c(0,0)) +
scale_x_continuous(breaks=seq(0.5, 2, 0.5), limits=c(0,2.3), expand=c(0,0)) +
theme_classic() +
theme(axis.text.x=element_blank(), axis.text.y = element_text(size=10), axis.title=element_blank(),
axis.ticks.x=element_blank(), axis.line.x = element_blank()) +
annotate("text", x = 0.5, y = 24.5, label= "Consistent with 1:1 Relationship", hjust = 0, color = pcolor) +
annotate("text", x = 0.5, y = 23.5, label= "Deviates from 1:1 Relationship", hjust = 0)
g2 <- ggplot(empty_df) + geom_point() +
geom_hline(yintercept = 25.7) +
scale_x_continuous(breaks=seq(3,4,0.5), limits=c(2.7,4.2), expand=c(0,0)) +
scale_y_continuous(breaks=seq(23,25,1), limits=c(22.47,25.7), expand=c(0,0)) +
theme_classic() +
theme(axis.text=element_blank(), axis.title=element_blank(), axis.ticks=element_blank(),
axis.line = element_blank())
g3 <- ggplot(data=df3, aes(x= geno_var_ratio, y= env_var_ratio)) +
geom_hline(yintercept = 25.7) + geom_vline(xintercept = 108) +
geom_point(size=2, alpha=0.5) +
geom_errorbar(aes(y=env_var_ratio, ymin=env_var_ratio-2*env_var_ratio_se, ymax=env_var_ratio+2*env_var_ratio_se), width=0) +
geom_errorbarh(aes(y=env_var_ratio, xmin=geno_var_ratio-2*geno_var_ratio_se, xmax=geno_var_ratio+2*geno_var_ratio_se), height=0) +
scale_y_continuous(breaks=seq(23,25,1), limits=c(22.47,25.7), expand=c(0,0)) +
scale_x_continuous(breaks=seq(60,100,20), limits=c(51,108), expand=c(0,0)) +
theme_classic() +
theme(axis.text=element_blank(), axis.title=element_blank(), axis.ticks=element_blank(),
axis.line=element_blank()) +
geom_text(aes(label=pheno_name), size=anno_size,x=75,y=24) +
coord_cartesian(clip = "off")
g3 <- ggplot(data=df3, aes(x= geno_var_ratio, y= env_var_ratio)) +
geom_hline(yintercept = 25.7) + geom_vline(xintercept = 108) +
geom_point(size=2, alpha=0.5) +
geom_errorbar(aes(y=env_var_ratio, ymin=env_var_ratio-2*env_var_ratio_se, ymax=env_var_ratio+2*env_var_ratio_se), width=0) +
geom_errorbarh(aes(y=env_var_ratio, xmin=geno_var_ratio-2*geno_var_ratio_se, xmax=geno_var_ratio+2*geno_var_ratio_se), height=0) +
scale_y_continuous(breaks=seq(23,25,1), limits=c(22.47,25.7), expand=c(0,0)) +
scale_x_continuous(breaks=seq(60,100,20), limits=c(51,108), expand=c(0,0)) +
theme_classic() +
theme(axis.text=element_blank(), axis.title=element_blank(), axis.ticks=element_blank(),
axis.line=element_blank()) +
geom_text(aes(label=pheno_name), size=anno_size,x=75,y=24) +
coord_cartesian(clip = "off")
g4 <- ggplot(data=df1, aes(x= geno_var_ratio, y= env_var_ratio, color=on)) +
geom_point(size=2, alpha=0.5) +
geom_abline(slope = 1, intercept = 0, color=pcolor, size=0.8) +
geom_errorbar(aes(y=env_var_ratio, ymin=env_var_ratio-2*env_var_ratio_se, ymax=env_var_ratio+2*env_var_ratio_se),
width=0) +
geom_errorbarh(aes(y=env_var_ratio, xmin=geno_var_ratio-2*geno_var_ratio_se, xmax=geno_var_ratio+2*geno_var_ratio_se),
height=0) +
scale_y_continuous(breaks=c(1,2,3), limits=c(0,3.5), expand=c(0,0)) +
scale_x_continuous(breaks=seq(0.5, 2, 0.5), limits=c(0,2.3), expand=c(0,0)) +
theme_classic() +
theme(axis.text.x = element_text(size=10), axis.title=element_blank(), legend.position = "none") +
scale_color_continuous(low = "black", high = pcolor) +
geom_text_repel(data=(df1_1), aes(label=pheno_name, fontface = on), size=anno_size, max.overlaps=Inf, segment.alpha=0.5,
ylim=c(1.5,NA), box.padding=1.5, segment.linetype=2) +
geom_text_repel(data=(df1_2), aes(label=pheno_name, fontface = on), size=anno_size, max.overlaps=Inf, segment.alpha=0.5,
ylim=c(NA,0.9), box.padding=1.5, segment.linetype=2)
g5 <- ggplot(data=df2, aes(x= geno_var_ratio, y= env_var_ratio, color=on)) +
geom_point(size=2, alpha=0.5) +
geom_abline(slope = 1, intercept = 0, color=pcolor, size= 0.8) +
geom_errorbar(aes(y=env_var_ratio, ymin=env_var_ratio-2*env_var_ratio_se,
ymax=env_var_ratio+2*env_var_ratio_se), width=0) +
geom_errorbarh(aes(y=env_var_ratio, xmin=geno_var_ratio-2*geno_var_ratio_se, xmax=geno_var_ratio+2*geno_var_ratio_se),
height=0) +
scale_x_continuous(breaks=seq(3,4,0.5), limits=c(2.7,4.2), expand=c(0,0)) +
scale_y_continuous(breaks=c(1,2,3), limits=c(0,3.5), expand=c(0,0)) +
theme_classic() +
theme(axis.text.y=element_blank(), axis.text.x = element_text(size=10), axis.title=element_blank(),
axis.ticks.y=element_blank(), axis.line.y = element_blank()) +
geom_text_repel(aes(label=pheno_name), size=anno_size, max.overlaps=Inf, segment.alpha=0, segment.linetype=2) +
annotate("text", x=3.3, y=2.3, label = "1:1 Relationship", color= pcolor)
g5
g5 <- ggplot(data=df2, aes(x= geno_var_ratio, y= env_var_ratio, color=on)) +
geom_point(size=2, alpha=0.5) +
geom_abline(slope = 1, intercept = 0, color=pcolor, size= 0.8) +
geom_errorbar(aes(y=env_var_ratio, ymin=env_var_ratio-2*env_var_ratio_se,
ymax=env_var_ratio+2*env_var_ratio_se), width=0) +
geom_errorbarh(aes(y=env_var_ratio, xmin=geno_var_ratio-2*geno_var_ratio_se, xmax=geno_var_ratio+2*geno_var_ratio_se),
height=0) +
scale_x_continuous(breaks=seq(3,4,0.5), limits=c(2.7,4.2), expand=c(0,0)) +
scale_y_continuous(breaks=c(1,2,3), limits=c(0,3.5), expand=c(0,0)) +
theme_classic() +
theme(axis.text.y=element_blank(), axis.text.x = element_text(size=10), axis.title=element_blank(),
axis.ticks.y=element_blank(), axis.line.y = element_blank()) +
scale_color_continuous(low = "black", high = pcolor) +
geom_text_repel(aes(label=pheno_name), size=anno_size, max.overlaps=Inf, segment.alpha=0, segment.linetype=2) +
annotate("text", x=3.3, y=2.3, label = "1:1 Relationship", color= pcolor)
g5
g5 <- ggplot(data=df2, aes(x= geno_var_ratio, y= env_var_ratio, color=on)) +
geom_point(size=2, alpha=0.5) +
geom_abline(slope = 1, intercept = 0, color=pcolor, size= 0.8) +
geom_errorbar(aes(y=env_var_ratio, ymin=env_var_ratio-2*env_var_ratio_se,
ymax=env_var_ratio+2*env_var_ratio_se), width=0) +
geom_errorbarh(aes(y=env_var_ratio, xmin=geno_var_ratio-2*geno_var_ratio_se, xmax=geno_var_ratio+2*geno_var_ratio_se),
height=0) +
scale_x_continuous(breaks=seq(3,4,0.5), limits=c(2.7,4.2), expand=c(0,0)) +
scale_y_continuous(breaks=c(1,2,3), limits=c(0,3.5), expand=c(0,0)) +
theme_classic() +
theme(axis.text.y=element_blank(), axis.text.x = element_text(size=10), axis.title=element_blank(),
axis.ticks.y=element_blank(), axis.line.y = element_blank(), legend.position = "none") +
scale_color_continuous(low = "black", high = pcolor) +
geom_text_repel(aes(label=pheno_name), size=anno_size, max.overlaps=Inf, segment.alpha=0, segment.linetype=2) +
annotate("text", x=3.3, y=2.3, label = "1:1 Relationship", color= pcolor)
g5
g6 <- ggplot(empty_df) + geom_point() +
geom_vline(xintercept = 108) +
scale_x_continuous(breaks=seq(60,100,20), limits=c(51,108), expand=c(0,0)) +
scale_y_continuous(breaks=c(1,2,3), limits=c(0,3.5), expand=c(0,0)) +
theme_classic() +
theme(axis.text.y=element_blank(), axis.text.x = element_text(size=10), axis.title=element_blank(),
axis.ticks.y=element_blank(), axis.line.y = element_blank())
gA <- ggplotGrob(g1) ; gB <- ggplotGrob(g4)
maxWidth = grid::unit.pmax(gA$widths[2:5], gB$widths[2:5])
gA$widths[2:5] <- as.list(maxWidth) ; gB$widths[2:5] <- as.list(maxWidth)
plot <- grid.arrange(gA, g2, g3, gB, g5, g6, ncol=3, nrow=2, widths=c(6,2,1), heights=c(1,4))
annotate_figure(plot,
bottom = text_grob("Genetic Variance Male:Female Ratio", size=12),
left = text_grob("Environmental Variance Male:Female Ratio", size=12, rot=90),
top = text_grob("Genetic and Environmental Variance \n Relationship between Males and Females", face = "bold", size = 16))
g4 <- ggplot(data=df1, aes(x= geno_var_ratio, y= env_var_ratio, color=on)) +
geom_point(size=2, alpha=0.5) +
geom_abline(slope = 1, intercept = 0, color=pcolor, size=0.8) +
geom_errorbar(aes(y=env_var_ratio, ymin=env_var_ratio-2*env_var_ratio_se, ymax=env_var_ratio+2*env_var_ratio_se),
width=0) +
geom_errorbarh(aes(y=env_var_ratio, xmin=geno_var_ratio-2*geno_var_ratio_se, xmax=geno_var_ratio+2*geno_var_ratio_se),
height=0) +
scale_y_continuous(breaks=c(1,2,3), limits=c(0,3.5), expand=c(0,0)) +
scale_x_continuous(breaks=seq(0.5, 2, 0.5), limits=c(0,2.3), expand=c(0,0)) +
theme_classic() +
theme(axis.text.x = element_text(size=10), axis.title=element_blank(), legend.position = "none") +
scale_color_continuous(low = "black", high = pcolor) +
geom_text_repel(data=(df1_1), aes(label=pheno_name), size=anno_size, max.overlaps=Inf, segment.alpha=0.5,
ylim=c(1.5,NA), box.padding=1.5, segment.linetype=2) +
geom_text_repel(data=(df1_2), aes(label=pheno_name), size=anno_size, max.overlaps=Inf, segment.alpha=0.5,
ylim=c(NA,0.9), box.padding=1.5, segment.linetype=2)
g5 <- ggplot(data=df2, aes(x= geno_var_ratio, y= env_var_ratio, color=on)) +
geom_point(size=2, alpha=0.5) +
geom_abline(slope = 1, intercept = 0, color=pcolor, size= 0.8) +
geom_errorbar(aes(y=env_var_ratio, ymin=env_var_ratio-2*env_var_ratio_se,
ymax=env_var_ratio+2*env_var_ratio_se), width=0) +
geom_errorbarh(aes(y=env_var_ratio, xmin=geno_var_ratio-2*geno_var_ratio_se, xmax=geno_var_ratio+2*geno_var_ratio_se),
height=0) +
scale_x_continuous(breaks=seq(3,4,0.5), limits=c(2.7,4.2), expand=c(0,0)) +
scale_y_continuous(breaks=c(1,2,3), limits=c(0,3.5), expand=c(0,0)) +
theme_classic() +
theme(axis.text.y=element_blank(), axis.text.x = element_text(size=10), axis.title=element_blank(),
axis.ticks.y=element_blank(), axis.line.y = element_blank(), legend.position = "none") +
scale_color_continuous(low = "black", high = pcolor) +
geom_text_repel(aes(label=pheno_name), size=anno_size, max.overlaps=Inf, segment.alpha=0, segment.linetype=2) +
annotate("text", x=3.3, y=2.3, label = "1:1 Relationship", color= pcolor)
g6 <- ggplot(empty_df) + geom_point() +
geom_vline(xintercept = 108) +
scale_x_continuous(breaks=seq(60,100,20), limits=c(51,108), expand=c(0,0)) +
scale_y_continuous(breaks=c(1,2,3), limits=c(0,3.5), expand=c(0,0)) +
theme_classic() +
theme(axis.text.y=element_blank(), axis.text.x = element_text(size=10), axis.title=element_blank(),
axis.ticks.y=element_blank(), axis.line.y = element_blank())
gA <- ggplotGrob(g1) ; gB <- ggplotGrob(g4)
maxWidth = grid::unit.pmax(gA$widths[2:5], gB$widths[2:5])
gA$widths[2:5] <- as.list(maxWidth) ; gB$widths[2:5] <- as.list(maxWidth)
plot <- grid.arrange(gA, g2, g3, gB, g5, g6, ncol=3, nrow=2, widths=c(6,2,1), heights=c(1,4))
annotate_figure(plot,
bottom = text_grob("Genetic Variance Male:Female Ratio", size=12),
left = text_grob("Environmental Variance Male:Female Ratio", size=12, rot=90),
top = text_grob("Genetic and Environmental Variance \n Relationship between Males and Females", face = "bold", size = 16))
g4 <- ggplot(data=df1, aes(x= geno_var_ratio, y= env_var_ratio, color=on)) +
geom_point(size=2, alpha=0.5) +
geom_abline(slope = 1, intercept = 0, color=pcolor, size=0.8) +
geom_errorbar(aes(y=env_var_ratio, ymin=env_var_ratio-2*env_var_ratio_se, ymax=env_var_ratio+2*env_var_ratio_se),
width=0) +
geom_errorbarh(aes(y=env_var_ratio, xmin=geno_var_ratio-2*geno_var_ratio_se, xmax=geno_var_ratio+2*geno_var_ratio_se),
height=0) +
scale_y_continuous(breaks=c(1,2,3), limits=c(0,3.5), expand=c(0,0)) +
scale_x_continuous(breaks=seq(0.5, 2, 0.5), limits=c(0,2.3), expand=c(0,0)) +
theme_classic() +
theme(axis.text.x = element_text(size=10), axis.title=element_blank(), legend.position = "none") +
scale_color_continuous(low = "black", high = pcolor) +
geom_text_repel(data=(df1_1), aes(label=pheno_name, fontface = on), size=anno_size, max.overlaps=Inf, segment.alpha=0.5,
ylim=c(1.5,NA), box.padding=1.5, segment.linetype=2) +
geom_text_repel(data=(df1_2), aes(label=pheno_name, fontface = on), size=anno_size, max.overlaps=Inf, segment.alpha=0.5,
ylim=c(NA,0.9), box.padding=1.5, segment.linetype=2)
g5 <- ggplot(data=df2, aes(x= geno_var_ratio, y= env_var_ratio, color=on)) +
geom_point(size=2, alpha=0.5) +
geom_abline(slope = 1, intercept = 0, color=pcolor, size= 0.8) +
geom_errorbar(aes(y=env_var_ratio, ymin=env_var_ratio-2*env_var_ratio_se,
ymax=env_var_ratio+2*env_var_ratio_se), width=0) +
geom_errorbarh(aes(y=env_var_ratio, xmin=geno_var_ratio-2*geno_var_ratio_se, xmax=geno_var_ratio+2*geno_var_ratio_se),
height=0) +
scale_x_continuous(breaks=seq(3,4,0.5), limits=c(2.7,4.2), expand=c(0,0)) +
scale_y_continuous(breaks=c(1,2,3), limits=c(0,3.5), expand=c(0,0)) +
theme_classic() +
theme(axis.text.y=element_blank(), axis.text.x = element_text(size=10), axis.title=element_blank(),
axis.ticks.y=element_blank(), axis.line.y = element_blank(), legend.position = "none") +
scale_color_continuous(low = "black", high = pcolor) +
geom_text_repel(aes(label=pheno_name), size=anno_size, max.overlaps=Inf, segment.alpha=0, segment.linetype=2, fontface = on) +
annotate("text", x=3.3, y=2.3, label = "1:1 Relationship", color= pcolor)
g6 <- ggplot(empty_df) + geom_point() +
geom_vline(xintercept = 108) +
scale_x_continuous(breaks=seq(60,100,20), limits=c(51,108), expand=c(0,0)) +
scale_y_continuous(breaks=c(1,2,3), limits=c(0,3.5), expand=c(0,0)) +
theme_classic() +
theme(axis.text.y=element_blank(), axis.text.x = element_text(size=10), axis.title=element_blank(),
axis.ticks.y=element_blank(), axis.line.y = element_blank())
gA <- ggplotGrob(g1) ; gB <- ggplotGrob(g4)
maxWidth = grid::unit.pmax(gA$widths[2:5], gB$widths[2:5])
gA$widths[2:5] <- as.list(maxWidth) ; gB$widths[2:5] <- as.list(maxWidth)
plot <- grid.arrange(gA, g2, g3, gB, g5, g6, ncol=3, nrow=2, widths=c(6,2,1), heights=c(1,4))
g4 <- ggplot(data=df1, aes(x= geno_var_ratio, y= env_var_ratio, color=on)) +
geom_point(size=2, alpha=0.5) +
geom_abline(slope = 1, intercept = 0, color=pcolor, size=0.8) +
geom_errorbar(aes(y=env_var_ratio, ymin=env_var_ratio-2*env_var_ratio_se, ymax=env_var_ratio+2*env_var_ratio_se),
width=0) +
geom_errorbarh(aes(y=env_var_ratio, xmin=geno_var_ratio-2*geno_var_ratio_se, xmax=geno_var_ratio+2*geno_var_ratio_se),
height=0) +
scale_y_continuous(breaks=c(1,2,3), limits=c(0,3.5), expand=c(0,0)) +
scale_x_continuous(breaks=seq(0.5, 2, 0.5), limits=c(0,2.3), expand=c(0,0)) +
theme_classic() +
theme(axis.text.x = element_text(size=10), axis.title=element_blank(), legend.position = "none") +
scale_color_continuous(low = "black", high = pcolor) +
geom_text_repel(data=(df1_1), aes(label=pheno_name, fontface = on), size=anno_size, max.overlaps=Inf, segment.alpha=0.5,
ylim=c(1.5,NA), box.padding=1.5, segment.linetype=2) +
geom_text_repel(data=(df1_2), aes(label=pheno_name, fontface = on), size=anno_size, max.overlaps=Inf, segment.alpha=0.5,
ylim=c(NA,0.9), box.padding=1.5, segment.linetype=2)
g5 <- ggplot(data=df2, aes(x= geno_var_ratio, y= env_var_ratio, color=on)) +
geom_point(size=2, alpha=0.5) +
geom_abline(slope = 1, intercept = 0, color=pcolor, size= 0.8) +
geom_errorbar(aes(y=env_var_ratio, ymin=env_var_ratio-2*env_var_ratio_se,
ymax=env_var_ratio+2*env_var_ratio_se), width=0) +
geom_errorbarh(aes(y=env_var_ratio, xmin=geno_var_ratio-2*geno_var_ratio_se, xmax=geno_var_ratio+2*geno_var_ratio_se),
height=0) +
scale_x_continuous(breaks=seq(3,4,0.5), limits=c(2.7,4.2), expand=c(0,0)) +
scale_y_continuous(breaks=c(1,2,3), limits=c(0,3.5), expand=c(0,0)) +
theme_classic() +
theme(axis.text.y=element_blank(), axis.text.x = element_text(size=10), axis.title=element_blank(),
axis.ticks.y=element_blank(), axis.line.y = element_blank(), legend.position = "none") +
scale_color_continuous(low = "black", high = pcolor) +
geom_text_repel(aes(label=pheno_name, fontface = on), size=anno_size, max.overlaps=Inf, segment.alpha=0, segment.linetype=2) +
annotate("text", x=3.3, y=2.3, label = "1:1 Relationship", color= pcolor)
g6 <- ggplot(empty_df) + geom_point() +
geom_vline(xintercept = 108) +
scale_x_continuous(breaks=seq(60,100,20), limits=c(51,108), expand=c(0,0)) +
scale_y_continuous(breaks=c(1,2,3), limits=c(0,3.5), expand=c(0,0)) +
theme_classic() +
theme(axis.text.y=element_blank(), axis.text.x = element_text(size=10), axis.title=element_blank(),
axis.ticks.y=element_blank(), axis.line.y = element_blank())
gA <- ggplotGrob(g1) ; gB <- ggplotGrob(g4)
maxWidth = grid::unit.pmax(gA$widths[2:5], gB$widths[2:5])
gA$widths[2:5] <- as.list(maxWidth) ; gB$widths[2:5] <- as.list(maxWidth)
plot <- grid.arrange(gA, g2, g3, gB, g5, g6, ncol=3, nrow=2, widths=c(6,2,1), heights=c(1,4))
annotate_figure(plot,
bottom = text_grob("Genetic Variance Male:Female Ratio", size=12),
left = text_grob("Environmental Variance Male:Female Ratio", size=12, rot=90),
top = text_grob("Genetic and Environmental Variance \n Relationship between Males and Females", face = "bold", size = 16))
