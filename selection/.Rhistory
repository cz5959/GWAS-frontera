require("dplyr")
require("tidyr")
require("ggplot2")
require("grid")
require("gridExtra")
require("ggpubr")
setwd("~/Research/GWAS-frontera/LDSC")
df <- read.csv("ldsc_results.txt", sep="\t")
both_h2 <- rep(df[df$Sex == "both_sex", "Heritability"], each=3)
asterick_pheno <- c("arm_fatfree_mass_R", "weight", "arm_fatfree_mass_L", "bmi",
"whole_body_fat_mass", "waist_circ", "hip_circ", "waist_to_hip_ratio")
df <- df %>%
mutate(relative_h2 = Heritability / both_h2) %>%
mutate(relative_h2_se = ((Heritability + h2.std.error) / both_h2) - relative_h2 ) %>%
mutate(Sex = factor(Sex, levels=c("female","both_sex","male"))) %>%
mutate(star = ifelse((Code %in% asterick_pheno) & (Sex == 'both_sex'), "*", NA)) %>%
arrange(Correlation, Phenotype, Sex) %>%
mutate(Phenotype = factor(Phenotype, levels=unique(Phenotype)))
#write.table(df, file = "relative_h2.txt", quote=FALSE, sep="\t", row.names=FALSE)
# relative heritability diff by correlation
df <- df[df$Sex != 'both_sex', c(1,3,6,8,9)]
f <- df[df$Sex == 'female',]
m <- df[df$Sex == 'male',]
setwd("~/Research/GWAS-frontera/LDSC")
df <- read.csv("ldsc_results.txt", sep="\t")
# load RData files (from Matt)
setwd("~/Research/GWAS-frontera/selection")
load("fst_plot_whole_body_fat_mass.RData"); wbfm <- pointsf
load("fst_plot_waist_circ.RData"); waist <- pointsf
load("zscore_plot.RData")
head(results)
results[results$TRAIT == "calcium",]
results[results$TRAIT == "Calcium",]
results[results$TRAIT == "Whole_body_fat_mass",]
results[results$TRAIT == "whole_body_fat_mass",]
unique(results$TRAIT)
results[results$TRAIT == "Whole body fat mass",]
results[results$TRAIT == "Waist circumference",]
results[results$TRAIT == "Whole body fat mass",]
results[results$TRAIT == "Waist circumference",]
load("zscore_plot_1e-05.RData")
results[results$TRAIT == "Waist circumference",]
load("zscore_plot.RData")
results[results$TRAIT == "Waist circumference",]
results[results$TRAIT == "Calcium",]
