require("dplyr")
require("tidyr")
require("reshape2")
require("matrixStats")
require("ggplot2")
require("ggsci")
require("ggpubr")
require("gridExtra")
# load RData files (from Matt)
setwd("~/Research/GWAS-frontera/selection")
load("fst_plot_whole_body_fat_mass.RData"); wbfm <- pointsf
load("fst_plot_waist_circ.RData"); waist <- pointsf
load("zscore_plot.RData")
# split results by ancestry
azj <- results[results$ANC == "Ashkenazi Jewish",]
fin <- results[results$ANC == "Finnish",]
nfe <- results[results$ANC == "Non-Finnish European",]
### FST PLOT
# size 3x4
f1 <- ggplot(wbfm, aes(x=V, y=FST, weight=w)) +
geom_point(color = "black", alpha= 0.1, size=1) +
geom_smooth(method = "lm", se=F, color= "blue", size=0.5) +
theme_classic() +
xlab("VGxSex (cm2)") +
theme(axis.title.y=element_blank(), axis.title.x=element_text(size=10), axis.text=element_text(size=8))
f1
f2 <- ggplot(waist, aes(x=V, y=FST, weight=w)) +
geom_point(color = "black", alpha= 0.1, size=1) +
geom_smooth(method = "lm", se=F, color= "red", size=0.5) +
theme_classic() +
xlab("VGxSex (cm)") +
theme(axis.title.y=element_blank(), axis.title.x=element_text(size=10), axis.text=element_text(size=8))
f2
fa <- ggplotGrob(f1) ; fb <- ggplotGrob(f2)
maxWidth = grid::unit.pmax(fa$widths[2:5], fb$widths[2:5])
fa$widths[2:5] <- as.list(maxWidth) ; fb$widths[2:5] <- as.list(maxWidth)
fplot <- grid.arrange(fa, fb, ncol=1, nrow=2)
annotate_figure(fplot,
left = text_grob("FST Between Males and Females", size=10, rot=90))
### FST PLOT
# size 3x4
f1 <- ggplot(wbfm, aes(x=V, y=FST, weight=w)) +
geom_point(color = "black", alpha= 0.1, size=1) +
geom_smooth(method = "lm", se=F, color= "blue", size=0.5) +
theme_classic() +
scale_y_continuous(breaks=c(0,3*10^-2))
### FST PLOT
# size 3x4
f1 <- ggplot(wbfm, aes(x=V, y=FST, weight=w)) +
geom_point(color = "black", alpha= 0.1, size=1) +
geom_smooth(method = "lm", se=F, color= "blue", size=0.5) +
theme_classic() +
scale_y_continuous(breaks=c(0,3*10^-2)) +
xlab("VGxSex (cm2)") +
theme(axis.title.y=element_blank(), axis.title.x=element_text(size=10), axis.text=element_text(size=8))
f1
### FST PLOT
# size 3x4
f1 <- ggplot(wbfm, aes(x=V, y=FST, weight=w)) +
geom_point(color = "black", alpha= 0.1, size=1) +
geom_smooth(method = "lm", se=F, color= "blue", size=0.5) +
theme_classic() +
scale_y_continuous(breaks=c(0,0.003)) +
xlab("VGxSex (cm2)") +
theme(axis.title.y=element_blank(), axis.title.x=element_text(size=10), axis.text=element_text(size=8))
f1
### FST PLOT
# size 3x4
f1 <- ggplot(wbfm, aes(x=V, y=FST, weight=w)) +
geom_point(color = "black", alpha= 0.1, size=1) +
geom_smooth(method = "lm", se=F, color= "blue", size=0.5) +
theme_classic() +
scale_y_continuous(breaks=c(0,0.003), labels=c("","3e-3")) +
xlab("VGxSex (cm2)") +
theme(axis.title.y=element_blank(), axis.title.x=element_text(size=10), axis.text=element_text(size=8))
f1
### FST PLOT
# size 3x4
f1 <- ggplot(wbfm, aes(x=V, y=FST, weight=w)) +
geom_point(color = "black", alpha= 0.1, size=1) +
geom_smooth(method = "lm", se=F, color= "blue", size=0.5) +
theme_classic() +
scale_y_continuous(breaks=c(0,0.003), labels=c("","3e-3"), expand=c(0,0)) +
xlab("VGxSex (cm2)") +
theme(axis.title.y=element_blank(), axis.title.x=element_text(size=10), axis.text=element_text(size=8))
f1
### FST PLOT
# size 3x4
f1 <- ggplot(wbfm, aes(x=V, y=FST, weight=w)) +
geom_point(color = "black", alpha= 0.1, size=1) +
geom_smooth(method = "lm", se=F, color= "blue", size=0.5) +
theme_classic() +
scale_y_continuous(breaks=c(0,0.003), labels=c("","3e-3"), expand=c(0,0)) +
scale_y_continuous(breaks=c(0,0.006), labels=c("","6e-3"), expand=c(0,0)) +
xlab("VGxSex (cm2)") +
theme(axis.title.y=element_blank(), axis.title.x=element_text(size=10), axis.text=element_text(size=8))
### FST PLOT
# size 3x4
f1 <- ggplot(wbfm, aes(x=V, y=FST, weight=w)) +
geom_point(color = "black", alpha= 0.1, size=1) +
geom_smooth(method = "lm", se=F, color= "blue", size=0.5) +
theme_classic() +
scale_y_continuous(breaks=c(0,0.003), labels=c("","3e-3"), expand=c(0,0)) +
scale_x_continuous(breaks=c(0,0.006), labels=c("","6e-3"), expand=c(0,0)) +
xlab("VGxSex (cm2)") +
theme(axis.title.y=element_blank(), axis.title.x=element_text(size=10), axis.text=element_text(size=8))
f1
f2 <- ggplot(waist, aes(x=V, y=FST, weight=w)) +
geom_point(color = "black", alpha= 0.1, size=1) +
geom_smooth(method = "lm", se=F, color= "red", size=0.5) +
theme_classic() +
xlab("VGxSex (cm)") +
theme(axis.title.y=element_blank(), axis.title.x=element_text(size=10), axis.text=element_text(size=8))
f2
f1
f2 <- ggplot(waist, aes(x=V, y=FST, weight=w)) +
geom_point(color = "black", alpha= 0.1, size=1) +
geom_smooth(method = "lm", se=F, color= "red", size=0.5) +
theme_classic() +
xlab("VGxSex (cm)") +
theme(axis.title.y=element_blank(), axis.title.x=element_text(size=10), axis.text=element_text(size=8))
f2
fa <- ggplotGrob(f1) ; fb <- ggplotGrob(f2)
maxWidth = grid::unit.pmax(fa$widths[2:5], fb$widths[2:5])
fa$widths[2:5] <- as.list(maxWidth) ; fb$widths[2:5] <- as.list(maxWidth)
fplot <- grid.arrange(fa, fb, ncol=1, nrow=2)
annotate_figure(fplot,
left = text_grob("FST Between Males and Females", size=10, rot=90))
### FST PLOT
# size 3x4
f1 <- ggplot(wbfm, aes(x=V, y=FST, weight=w)) +
geom_point(color = "black", alpha= 0.1, size=1) +
geom_smooth(method = "lm", se=F, color= "blue", size=0.5) +
theme_classic() +
scale_y_continuous(breaks=c(0,0.003), labels=c("","3e-3"), expand=c(0,0)) +
scale_x_continuous(breaks=c(0,0.006), labels=c("","6e-3"), expand=c(0.001,0)) +
xlab("VGxSex (cm2)") +
theme(axis.title.y=element_blank(), axis.title.x=element_text(size=10), axis.text=element_text(size=8))
f1
### FST PLOT
# size 3x4
f1 <- ggplot(wbfm, aes(x=V, y=FST, weight=w)) +
geom_point(color = "black", alpha= 0.1, size=1) +
geom_smooth(method = "lm", se=F, color= "blue", size=0.5) +
theme_classic() +
scale_y_continuous(breaks=c(0,0.003), labels=c("","3e-3"), expand=c(0,0)) +
scale_x_continuous(breaks=c(0,0.006), labels=c("","6e-3"), expand=c(1,0)) +
xlab("VGxSex (cm2)") +
theme(axis.title.y=element_blank(), axis.title.x=element_text(size=10), axis.text=element_text(size=8))
f1
### FST PLOT
# size 3x4
f1 <- ggplot(wbfm, aes(x=V, y=FST, weight=w)) +
geom_point(color = "black", alpha= 0.1, size=1) +
geom_smooth(method = "lm", se=F, color= "blue", size=0.5) +
theme_classic() +
scale_y_continuous(breaks=c(0,0.003), labels=c("","3e-3"), expand=c(0,0)) +
scale_x_continuous(breaks=c(0,0.006), labels=c("","6e-3"), expand=c(0.05,0)) +
xlab("VGxSex (cm2)") +
theme(axis.title.y=element_blank(), axis.title.x=element_text(size=10), axis.text=element_text(size=8))
f1
### FST PLOT
# size 3x4
f1 <- ggplot(wbfm, aes(x=V, y=FST, weight=w)) +
geom_point(color = "black", alpha= 0.1, size=1) +
geom_smooth(method = "lm", se=F, color= "blue", size=0.5) +
theme_classic() +
scale_y_continuous(breaks=c(0,0.003), labels=c("","3e-3")) +
scale_x_continuous(breaks=c(0,0.006), labels=c("","6e-3")) +
xlab("VGxSex (cm2)") +
theme(axis.title.y=element_blank(), axis.title.x=element_text(size=10), axis.text=element_text(size=8))
f1
f2 <- ggplot(waist, aes(x=V, y=FST, weight=w)) +
geom_point(color = "black", alpha= 0.1, size=1) +
geom_smooth(method = "lm", se=F, color= "red", size=0.5) +
theme_classic() +
xlab("VGxSex (cm)") +
theme(axis.title.y=element_blank(), axis.title.x=element_text(size=10), axis.text=element_text(size=8))
f2
f2 <- ggplot(waist, aes(x=V, y=FST, weight=w)) +
geom_point(color = "black", alpha= 0.1, size=1) +
geom_smooth(method = "lm", se=F, color= "red", size=0.5) +
theme_classic() +
scale_y_continuous(breaks=c(0,0.0015), labels=c("","1.5e-3")) +
scale_x_continuous(breaks=c(0,0.0075), labels=c("","7.5e-3")) +
xlab("VGxSex (cm)") +
theme(axis.title.y=element_blank(), axis.title.x=element_text(size=10), axis.text=element_text(size=8))
f2
fa <- ggplotGrob(f1) ; fb <- ggplotGrob(f2)
maxWidth = grid::unit.pmax(fa$widths[2:5], fb$widths[2:5])
fa$widths[2:5] <- as.list(maxWidth) ; fb$widths[2:5] <- as.list(maxWidth)
fplot <- grid.arrange(fa, fb, ncol=1, nrow=2)
annotate_figure(fplot,
left = text_grob("FST Between Males and Females", size=10, rot=90))
### FST PLOT
# size 3x4
f1 <- ggplot(wbfm, aes(x=V, y=FST, weight=w)) +
geom_point(color = "black", alpha= 0.1, size=1) +
geom_smooth(method = "lm", se=F, color= "blue", size=0.5) +
theme_classic() +
scale_y_continuous(breaks=c(0,0.003), labels=c("","3e-3")) +
scale_x_continuous(breaks=c(0,0.006), labels=c("","6e-3")) +
xlab("VGxSex") +
theme(axis.title.y=element_blank(), axis.title.x=element_text(size=10), axis.text=element_text(size=8))
f1
f2 <- ggplot(waist, aes(x=V, y=FST, weight=w)) +
geom_point(color = "black", alpha= 0.1, size=1) +
geom_smooth(method = "lm", se=F, color= "red", size=0.5) +
theme_classic() +
scale_y_continuous(breaks=c(0,0.0015), labels=c("","1.5e-3")) +
scale_x_continuous(breaks=c(0,0.0075), labels=c("","7.5e-3")) +
xlab("VGxSex") +
theme(axis.title.y=element_blank(), axis.title.x=element_text(size=10), axis.text=element_text(size=8))
f2
fa <- ggplotGrob(f1) ; fb <- ggplotGrob(f2)
maxWidth = grid::unit.pmax(fa$widths[2:5], fb$widths[2:5])
fa$widths[2:5] <- as.list(maxWidth) ; fb$widths[2:5] <- as.list(maxWidth)
fplot <- grid.arrange(fa, fb, ncol=1, nrow=2)
annotate_figure(fplot,
left = text_grob("FST Between Males and Females", size=10, rot=90))
### FST PLOT
# size 3x4
f1 <- ggplot(wbfm, aes(x=V, y=FST, weight=w)) +
geom_point(color = "black", alpha= 0.1, size=1) +
geom_smooth(method = "lm", se=F, color= "blue", size=0.5) +
theme_classic() +
scale_y_continuous(breaks=c(0,0.003), labels=c("","3e-3")) +
scale_x_continuous(breaks=c(0,0.006), labels=c("","6e-3")) +
theme(axis.title=element_blank(), axis.text=element_text(size=8))
f1
f2 <- ggplot(waist, aes(x=V, y=FST, weight=w)) +
geom_point(color = "black", alpha= 0.1, size=1) +
geom_smooth(method = "lm", se=F, color= "red", size=0.5) +
theme_classic() +
scale_y_continuous(breaks=c(0,0.0015), labels=c("","1.5e-3")) +
scale_x_continuous(breaks=c(0,0.0075), labels=c("","7.5e-3")) +
xlab("VGxSex") +
theme(axis.title.y=element_blank(), axis.title.x=element_text(size=10), axis.text=element_text(size=8))
f2
fa <- ggplotGrob(f1) ; fb <- ggplotGrob(f2)
maxWidth = grid::unit.pmax(fa$widths[2:5], fb$widths[2:5])
fa$widths[2:5] <- as.list(maxWidth) ; fb$widths[2:5] <- as.list(maxWidth)
fplot <- grid.arrange(fa, fb, ncol=1, nrow=2)
annotate_figure(fplot,
left = text_grob("FST Between Males and Females", size=10, rot=90))
